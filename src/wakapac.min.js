!function(){"use strict";const e={PROXY:"undefined"!=typeof Proxy,isReactive:e=>e&&"object"==typeof e&&!e.nodeType&&!(e instanceof Date)&&!(e instanceof RegExp)&&!(e instanceof File),deepEq:(t,i)=>{if(t===i)return!0;if(!t||!i||typeof t!=typeof i||"object"!=typeof t)return!1;const r=Object.keys(t),n=Object.keys(i);return r.length===n.length&&r.every((r=>n.includes(r)&&e.deepEq(t[r],i[r])))},id:()=>Date.now()+"_"+(1e4*Math.random()|0),isEvent:e=>/^(click|submit|change|input|focus|blur|key(up|down))$/.test(e)};function t(){this.units=new Map,this.cache=new WeakMap}function i(t,r,n=""){return e.isReactive(t)?e.PROXY?function(t,r,n){Object.keys(t).forEach((a=>{t.hasOwnProperty(a)&&e.isReactive(t[a])&&(t[a]=i(t[a],r,n?`${n}.${a}`:a))}));const a={},s=Array.isArray(t);s&&["push","pop","shift","unshift","splice","sort","reverse"].forEach((e=>{a[e]=t[e]}));return new Proxy(t,{get:(t,o)=>s&&a[o]?function(...s){const c=a[o].apply(t,s);return/^(push|unshift|splice)$/.test(o)&&t.forEach(((a,s)=>{e.isReactive(a)&&!a._reactive&&(t[s]=i(a,r,`${n}.${s}`))})),r(n||"root",t,"array-mutation",{method:o,args:s}),c}:t[o],set(t,a,s){const o=t[a];if(e.isReactive(s)&&(s=i(s,r,n?`${n}.${a}`:a)),t[a]=s,!e.deepEq(o,s)&&(r(n?`${n}.${a}`:a,s,"set",{old:o}),n&&n.includes("."))){const e=n.split(".")[0];r(e,null,"nested-property-change",{nestedPath:n?`${n}.${a}`:a,oldValue:o,newValue:s})}return!0},deleteProperty(e,t){const i=e[t];return delete e[t],r(n?`${n}.${t}`:t,void 0,"delete",{old:i}),!0}})}(t,r,n):function(t,r,n){Array.isArray(t)&&["push","pop","shift","unshift","splice","sort","reverse"].forEach((e=>{const i=t[e];Object.defineProperty(t,e,{value:function(...t){const a=i.apply(this,t);return r(n||"root",this,"array-mutation",{method:e,args:t}),a},enumerable:!1,configurable:!0})}));return Object.keys(t).forEach((a=>{t.hasOwnProperty(a)&&e.isReactive(t[a])&&(t[a]=i(t[a],r,n?`${n}.${a}`:a))})),Object.defineProperty(t,"_reactive",{value:!0,enumerable:!1}),t}(t,r,n):t}function r(t,r={},n={}){const a=document.querySelector(t);if(!a)throw new Error(`Container not found: ${t}`);const s=Object.assign({updateMode:"immediate",delay:300,deepReactivity:!0},n),o={bindings:new Map,abstraction:null,delays:new Map,parent:null,children:new Set,listeners:new Map,pending:null,pendingVals:null,orig:r,computedCache:new Map,computedDeps:new Map,propDeps:new Map,container:a,config:s,createBinding(e,t,i){const r={type:e,element:t,...i};return i.target&&(r.property=i.target.split(".")[0],r.propertyPath=i.target),r},updateBinding(e,t,i){const r=e.property===t||e.propertyPath&&e.propertyPath.startsWith(t+".");if(!r&&"foreach"!==e.type)return;const n={text:()=>this.updateText(e,t,i),attribute:()=>this.updateAttribute(e,t,i),input:()=>this.updateInput(e,t,i),checked:()=>this.updateChecked(e,t,i),visible:()=>this.updateVisible(e,i),foreach:()=>this.updateForeach(e,t,i)}[e.type];n&&(r||"foreach"===e.type)&&n.call(this)},updateForeach(e,t,i){if(e.collection!==t)return;const r=Array.isArray(i)?i:[],n=e.prev||[];this.arrEq(n,r)?e.prev=[...r]:(e.prev=[...r],e.element.innerHTML="",r.forEach(((t,i)=>{const r=this.renderItem(e.template,t,i,e.itemName,e.indexName);e.element.appendChild(r)})))},parseExpression(e){const t=(e=e.trim()).match(/^(.+?)\s*\?\s*(.+?)\s*:\s*(.+?)$/);if(t){const[,e,i,r]=t;return{type:"ternary",condition:e.trim(),trueValue:this.parseValue(i.trim()),falseValue:this.parseValue(r.trim()),dependencies:this.extractDependencies(e.trim())}}return{type:"property",path:e,dependencies:this.extractDependencies(e)}},parseValue:e=>(e=e.trim()).startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?{type:"literal",value:e.slice(1,-1)}:/^\d+(\.\d+)?$/.test(e)?{type:"literal",value:parseFloat(e)}:"true"===e||"false"===e?{type:"literal",value:"true"===e}:{type:"property",path:e},extractDependencies(e){const t=[],i=/\b([a-zA-Z_$][a-zA-Z0-9_$.]*)\b/g;let r;for(;r=i.exec(e);){const e=r[1];"true"===e||"false"===e||t.includes(e)||t.push(e)}return t},evaluateExpression(e){if("ternary"===e.type){return this.evaluateCondition(e.condition)?this.evaluateValue(e.trueValue):this.evaluateValue(e.falseValue)}if("property"===e.type)return this.resolvePropertyPath(e.path)},evaluateCondition(e){if(/^[a-zA-Z_$][a-zA-Z0-9_$.]*$/.test(e)){return!!this.resolvePropertyPath(e)}const t=e.match(/^(.+?)\s*(===|!==|==|!=|>=|<=|>|<)\s*(.+?)$/);if(t){const[,e,i,r]=t,n=this.resolvePropertyPath(e.trim()),a=this.parseAndEvaluateValue(r.trim());switch(i){case"===":return n===a;case"!==":return n!==a;case"==":return n==a;case"!=":return n!=a;case">=":return n>=a;case"<=":return n<=a;case">":return n>a;case"<":return n<a;default:return!1}}return!!this.resolvePropertyPath(e)},evaluateValue(e){return"literal"===e.type?e.value:"property"===e.type?this.resolvePropertyPath(e.path):void 0},parseAndEvaluateValue(e){const t=this.parseValue(e);return this.evaluateValue(t)},renderItem(e,t,i,r,n){const a=document.createElement("div");a.innerHTML=e;const s=a.firstElementChild||a.firstChild;if(!s)return document.createTextNode("");const o=s.cloneNode(!0);return this.processTemplate(o,t,i,r,n),o},processTemplate(e,t,i,r,n){const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT),s=[];let o;for(;o=a.nextNode();)s.push(o);s.forEach((e=>{let a=e.textContent;a=a.replace(new RegExp(`\\{\\{\\s*${r}\\.(\\w+)\\s*\\}\\}`,"g"),((e,i)=>t&&t.hasOwnProperty(i)?t[i]:"")),a=a.replace(new RegExp(`\\{\\{\\s*${r}\\s*\\}\\}`,"g"),(()=>"object"==typeof t?JSON.stringify(t):t||"")),a=a.replace(new RegExp(`\\{\\{\\s*${n}\\s*\\}\\}`,"g"),(()=>i)),e.textContent=a})),[e,...e.querySelectorAll("[data-pac-bind]")].forEach((e=>{const a=e.getAttribute("data-pac-bind");a&&a.split(",").forEach((a=>{const[s,o]=a.trim().split(":").map((e=>e.trim()));this.processBinding(e,s,o,t,i,r,n)}))}))},processBinding(t,i,r,n,a,s,o){const c={class:()=>{if(this.evalExpr(r,n,a,s,o)){const e=r.includes(".")?r.split(".").pop():r;t.classList.add(e)}},checked:()=>{t.checked=!!this.evalExpr(r,n,a,s,o)}};if(c[i])c[i]();else if(e.isEvent(i))t.addEventListener(i,(e=>{"function"==typeof this.abstraction[r]&&this.abstraction[r].call(this.abstraction,n,a,e)}));else{const e=this.evalExpr(r,n,a,s,o);null!=e&&t.setAttribute(i,e)}},evalExpr:(e,t,i,r,n)=>e===n?i:e===r?t:e.startsWith(`${r}.`)?e.substring(r.length+1).split(".").reduce(((e,t)=>e&&e.hasOwnProperty(t)?e[t]:void 0),t):e,arrEq:(t,i)=>t.length===i.length&&t.every(((t,r)=>e.deepEq(t,i[r]))),handleDeepChange(e,t,i,r){const n=e.split(".")[0];if("nested-property-change"===i||"set"===i&&e.includes(".")){let e=!1;const t=this.propDeps.get(n)||[];this.bindings.forEach(((i,r)=>{"foreach"===i.type&&(i.collection===n||t.includes(i.collection))&&(i.prev=null,e=!0)}))}this.updateComputed(n),("array-mutation"===i||"nested-property-change"===i||"set"===i||this.abstraction.hasOwnProperty(n))&&this.updateDOM(n,this.abstraction[n]),this.notifyParent("propertyChange",{property:n,path:e,newValue:t})},updateDOM(e,t){if(!this.pending){this.pending=new Set,this.pendingVals={};const e=this;(window.requestAnimationFrame||(e=>setTimeout(e,0)))((()=>{e.flushDOM()}))}this.pending.add(e),this.pendingVals[e]=t},flushDOM(){this.pending&&(this.pending.forEach((e=>{this.bindings.forEach((t=>this.updateBinding(t,e,this.pendingVals[e])))})),this.pending=null,this.pendingVals=null)},updateText(e,t,i){if(!(e.property===t||e.parsedExpression&&e.parsedExpression.dependencies.includes(t)))return;let r;r=e.parsedExpression&&e.expressionContent?this.evaluateExpression(e.parsedExpression):this.resolvePropertyPath(e.propertyPath||e.property);const n=this.formatDisplayValue(r),a=e.fullMatch.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(a,"g");(e.textNode||e.element).textContent=e.origText.replace(s,n)},updateAttribute(e,t,i){const r=e.propertyPath&&e.propertyPath!==e.property?this.resolvePropertyPath(e.propertyPath):i;null!=r?e.element.setAttribute(e.attribute,r):e.element.removeAttribute(e.attribute)},updateInput(e,t,i){e.property===t&&e.element.value!==i&&(e.element.value=i)},updateChecked(e,t,i){e.property===t&&e.element.checked!==!!i&&(e.element.checked=!!i)},updateVisible(e,t){const i=e.propertyPath&&e.propertyPath!==e.property?this.resolvePropertyPath(e.propertyPath):t,r=e.isNegated?!i:!!i;this.toggleElementVisibility(e.element,r)},formatDisplayValue:e=>"object"==typeof e&&null!==e?Array.isArray(e)?`[${e.length} items]`:JSON.stringify(e,null,2):null==e?"":e,toggleElementVisibility(e,t){if(t)e.hasAttribute("data-pac-hidden")&&(e.style.display=e.getAttribute("data-pac-orig-display")||"",e.removeAttribute("data-pac-hidden"),e.removeAttribute("data-pac-orig-display"));else if(!e.hasAttribute("data-pac-hidden")){const t=getComputedStyle(e).display;"none"!==t&&e.setAttribute("data-pac-orig-display",t),e.style.display="none",e.setAttribute("data-pac-hidden","true")}},resolvePropertyPath(e){return e.split(".").reduce(((e,t)=>null==e?void 0:e[t]),this.abstraction)},analyzeComputed(e){if(!e||"function"!=typeof e)return[];try{const t=[],i=/this\.([a-zA-Z_$][a-zA-Z0-9_$]*)/g;let r;for(;r=i.exec(e.toString());){const e=r[1];!this.orig.hasOwnProperty(e)||this.orig.computed&&this.orig.computed.hasOwnProperty(e)||t.includes(e)||t.push(e)}return t}catch(e){return console.error("Error analyzing computed function:",e),[]}},updateComputed(t){(this.propDeps.get(t)||[]).forEach((t=>{const i=this.computedCache.get(t);if(!this.orig.computed)return;const r=this.orig.computed[t];if(r&&"function"==typeof r)try{const n=r.call(this.abstraction);!Array.from(this.bindings.values()).some((e=>"foreach"===e.type&&e.collection===t))&&e.deepEq(i,n)||(this.computedCache.set(t,n),this.updateDOM(t,n),this.notifyParent("propertyChange",{property:t,oldValue:i,newValue:n,computed:!0}),this.updateComputed(t))}catch(e){console.error(`Error executing computed property '${t}':`,e)}}))},createReactiveAbs(){const e={};return this.setupComputedProperties(e),Object.keys(this.orig).forEach((t=>{if(this.orig.hasOwnProperty(t)&&"computed"!==t){const i=this.orig[t];"function"==typeof i?e[t]=i:this.createReactiveProp(e,t,i)}})),Object.assign(e,{notifyParent:(e,t)=>this.notifyParent(e,t),sendToChildren:(e,t)=>this.sendToChildren(e,t),sendToChild:(e,t,i)=>{const r=Array.from(this.children).find((t=>t.container.matches(e)));r&&r.receiveFromParent&&r.receiveFromParent(t,i)},findChild:e=>Array.from(this.children).find(e),toJSON:()=>{const e={},t=o.orig.computed?Object.keys(o.orig.computed):[];return Object.keys(o.abstraction).forEach((i=>{const r=o.abstraction[i];void 0===r||"function"==typeof r||t.includes(i)||["notifyParent","sendToChildren","sendToChild","findChild","toJSON"].includes(i)||(e[i]=r)})),e}}),e},setupComputedProperties(e){this.orig.computed&&Object.keys(this.orig.computed).forEach((t=>{const i=this.orig.computed[t];let r,n;if("function"==typeof i)r=i,n=null;else{if(!i||"object"!=typeof i)return void console.error(`Invalid computed property definition for '${t}'`);if(r=i.get,n=i.set,"function"!=typeof r)return void console.error(`Computed property '${t}' must have a getter function`)}try{const i=this.analyzeComputed(r);this.computedDeps.set(t,i),i.forEach((e=>{this.propDeps.has(e)||this.propDeps.set(e,[]);const i=this.propDeps.get(e);i.includes(t)||i.push(t)}));const a={get:()=>{try{const i=r.toString();if(/this\.children|this\.findChild|Array\.from\(this\.children\)/.test(i)){const i=r.call(e);return this.computedCache.set(t,i),i}{if(this.computedCache.has(t))return this.computedCache.get(t);const i=r.call(e);return this.computedCache.set(t,i),i}}catch(e){return void console.error(`Error computing property '${t}':`,e)}},enumerable:!0};n&&"function"==typeof n&&(a.set=i=>{try{this.computedCache.delete(t),n.call(e,i),this.computedCache.delete(t),this.updateDOM(t,e[t])}catch(e){console.error(`Error setting computed property '${t}':`,e)}}),Object.defineProperty(e,t,a)}catch(e){console.error(`Error setting up computed property '${t}':`,e)}}))},createReactiveProp(t,r,n){let a=n;this.config.deepReactivity&&e.isReactive(a)&&(a=i(a,((e,t,i,r)=>this.handleDeepChange(e,t,i,r)),r)),Object.defineProperty(t,r,{get:()=>a,set:t=>{if(e.isReactive(a)||e.isReactive(t)||!e.deepEq(a,t)){const n=a;this.config.deepReactivity&&e.isReactive(t)&&(t=i(t,((e,t,i,r)=>this.handleDeepChange(e,t,i,r)),r)),a=t,this.updateDOM(r,t),this.updateComputed(r),this.notifyParent("propertyChange",{property:r,oldValue:n,newValue:t})}},enumerable:!0})},setupBindings(){this.findTextBindings(),this.findAttrBindings()},findTextBindings(){const t=document.createTreeWalker(this.container,NodeFilter.SHOW_TEXT),i=[];let r;for(;r=t.nextNode();){const t=r.textContent,n=t.match(/\{\{\s*([^}]+)\s*\}\}/g);n&&n.forEach((n=>{const a=n.replace(/[{}\s]/g,"").trim(),s=this.parseExpression(a);(s.dependencies||[a.split(".")[0]]).forEach((o=>{const c=o.split(".")[0];i.push([e.id(),{type:"text",property:c,propertyPath:o,expressionContent:a,parsedExpression:s,element:r.parentElement,origText:t,textNode:r,fullMatch:n}])}))}))}i.forEach((([e,t])=>this.bindings.set(e,t)))},findAttrBindings(){const t=this.container.querySelectorAll('[data-pac-bind]:not([data-pac-bind*="foreach"] [data-pac-bind])'),i=[];Array.from(t).forEach((t=>{t.getAttribute("data-pac-bind").split(",").forEach((r=>{const[n,a]=r.trim().split(":").map((e=>e.trim())),s=r+"_"+e.id(),o={foreach:()=>this.createForeachBinding(t,a),visible:()=>this.createVisibilityBinding(t,a),value:()=>(this.setupInput(t,a),this.createInputBinding(t,a)),checked:()=>(this.setupInput(t,a,"checked"),this.createCheckedBinding(t,a))};o[n]?(i.push([s,o[n]()]),"foreach"===n&&(t.innerHTML="")):e.isEvent(n)?i.push([s,this.createEventBinding(t,n,a)]):r.includes(":")&&a?i.push([s,this.createAttributeBinding(t,n,a)]):r.includes(":")||console.error(`Invalid binding syntax: "${r}". Use "type:target" format.`)}))})),i.forEach((([e,t])=>this.bindings.set(e,t)))},createForeachBinding(e,t){return this.createBinding("foreach",e,{target:t,collection:t,itemName:e.getAttribute("data-pac-item")||"item",indexName:e.getAttribute("data-pac-index")||"index",template:e.innerHTML})},createEventBinding(e,t,i){return this.createBinding("event",e,{event:t,method:i})},createVisibilityBinding(e,t){const i=t.startsWith("!"),r=t.replace(/^!/,"");return this.createBinding("visible",e,{target:r,condition:t,isNegated:i})},createAttributeBinding(e,t,i){return this.createBinding("attribute",e,{target:i,attribute:t})},createInputBinding(e,t){return this.createBinding("input",e,{target:t,updateMode:e.getAttribute("data-pac-update-mode")||this.config.updateMode,delay:parseInt(e.getAttribute("data-pac-update-delay"))||this.config.delay})},createCheckedBinding(e,t){return this.createBinding("checked",e,{target:t,updateMode:e.getAttribute("data-pac-update-mode")||this.config.updateMode,delay:parseInt(e.getAttribute("data-pac-update-delay"))||this.config.delay})},setupInput(e,t,i="value"){e.setAttribute("data-pac-property",t),e.setAttribute("data-pac-binding-type",i),e.setAttribute("data-pac-update-mode",e.getAttribute("data-pac-update")||this.config.updateMode),e.setAttribute("data-pac-update-delay",e.getAttribute("data-pac-delay")||this.config.delay)},setupEvents(){["input","change","click","submit","focus","blur","keyup","keydown"].forEach((e=>{const t=e=>this.handleEvent(e);this.container.addEventListener(e,t),this.listeners.set(e,t)}))},handleEvent(e){const{type:t,target:i}=e,r=i.getAttribute("data-pac-property"),n={input:()=>r&&this.abstraction.hasOwnProperty(r)&&this._handleInputEvent(e,i,r),change:()=>r&&this.abstraction.hasOwnProperty(r)&&this._handleChangeEvent(e,i,r),default:()=>this._handleEventBinding(e,t,i)};(n[t]||n.default)()},_handleInputEvent(e,t,i){const r=t.getAttribute("data-pac-update-mode")||this.config.updateMode,n="checked"===(t.getAttribute("data-pac-binding-type")||"value")?t.checked:t.value,a={change:()=>t.setAttribute("data-pac-pending-value",n),immediate:()=>this.abstraction[i]=n,delayed:()=>this.updateFromDOM(t,i,n),default:()=>{console.warn(`Unknown update mode: ${r}. Using immediate.`),this.abstraction[i]=n}};(a[r]||a.default)()},_handleChangeEvent(e,t,i){const r=`${i}_${t.getAttribute("data-pac-property")}`,n=t.getAttribute("data-pac-binding-type")||"value";this.delays.has(r)&&(clearTimeout(this.delays.get(r)),this.delays.delete(r)),this.abstraction[i]="checked"===n?t.checked:t.value,t.removeAttribute("data-pac-pending-value")},_handleEventBinding(e,t,i){this.bindings.forEach((r=>{if("event"===r.type&&r.event===t&&r.element===i){const t=this.abstraction[r.method];if("function"!=typeof t)return void console.warn(`Event handler method '${r.method}' is not a function`);"submit"===r.event&&e.preventDefault(),e.stopPropagation();try{t.call(this.abstraction,e)}catch(e){console.error(`Error executing event handler '${r.method}':`,e)}}}))},updateFromDOM(e,t,i){const r=e.getAttribute("data-pac-update-mode")||this.config.updateMode,n=parseInt(e.getAttribute("data-pac-update-delay"))||this.config.delay;if("immediate"!==r){if("delayed"===r){const r=`${t}_${e.id||e.getAttribute("data-pac-property")}`;this.delays.has(r)&&clearTimeout(this.delays.get(r));const a=setTimeout((()=>{this.abstraction[t]=i,this.delays.delete(r)}),n);this.delays.set(r,a)}}else this.abstraction[t]=i},establishHierarchy(){const{parent:e,children:t}=window.PACRegistry.getHierarchy(this.container);e&&this.parent!==e&&(this.parent=e,e.children.add(this),this.refreshChildDependentComputed(e)),t.forEach((e=>{e.parent!==this&&(e.parent&&e.parent.children.delete(e),e.parent=this,this.children.add(e))})),this.refreshChildDependentComputed(this)},refreshChildDependentComputed(e){e.orig.computed&&Object.keys(e.orig.computed).forEach((t=>{const i=e.orig.computed[t];if("function"==typeof i){const r=i.toString();/this\.children|this\.findChild|Array\.from\(this\.children\)/.test(r)&&(e.computedCache.delete(t),e.updateDOM(t,e.abstraction[t]))}}))},notifyParent(e,t){this.parent&&"function"==typeof this.parent.receiveUpdate&&this.parent.receiveUpdate(e,t,this)},receiveUpdate(e,t,i){this.abstraction.onChildUpdate&&this.abstraction.onChildUpdate(e,t,i),this.container.dispatchEvent(new CustomEvent("pac:childupdate",{detail:{eventType:e,data:t,childPAC:i},bubbles:!0})),this.refreshChildDependentComputed(this)},receiveFromParent(e,t){this.abstraction.receiveFromParent&&this.abstraction.receiveFromParent(e,t),this.container.dispatchEvent(new CustomEvent("pac:parentcommand",{detail:{command:e,data:t},bubbles:!0}))},sendToChildren(e,t){this.children.forEach((i=>{"function"==typeof i.receiveFromParent&&i.receiveFromParent(e,t)}))},initialUpdate(){Object.keys(this.abstraction).forEach((e=>{this.abstraction.hasOwnProperty(e)&&"function"!=typeof this.abstraction[e]&&this.updateDOM(e,this.abstraction[e])})),this.orig.computed&&Object.keys(this.orig.computed).forEach((e=>{this.updateDOM(e,this.abstraction[e])})),this.bindings.forEach((e=>{if("foreach"===e.type){e.prev=[];const t=this.abstraction[e.collection];void 0!==t&&this.updateForeach(e,e.collection,t)}}))},destroy(){this.listeners.forEach(((e,t)=>{this.container.removeEventListener(t,e)})),this.delays.forEach((e=>clearTimeout(e))),this.parent&&this.parent.children.delete(this),this.children.forEach((e=>e.parent=null)),[this.computedCache,this.computedDeps,this.propDeps,this.bindings].forEach((e=>e.clear())),this.abstraction=null},init(){return this.setupBindings(),this.trackPropertyPathDependencies(),this.abstraction=this.createReactiveAbs(),this.setupEvents(),this.initialUpdate(),this},trackPropertyPathDependencies(){this.bindings.forEach((e=>{if("text"===e.type&&e.propertyPath){const t=e.propertyPath.split(".");for(let i=0;i<t.length;i++){const i=t[0];this.propDeps.has(i)||this.propDeps.set(i,[]);const r=this.propDeps.get(i);r.includes(e)||r.push(e)}}}))}};const c=function(e,t){const i={};return Object.assign(i,{addChild:e=>{t.children.add(e),e.parent=t},removeChild:e=>{t.children.delete(e),e.parent=null},notifyParent:(e,i)=>t.notifyParent(e,i),receiveUpdate:(e,i,r)=>t.receiveUpdate(e,i,r),receiveFromParent:(e,i)=>t.receiveFromParent(e,i),sendToChildren:(e,i)=>t.sendToChildren(e,i),sendToChild:(e,i,r)=>{const n=Array.from(t.children).find((t=>t.container.matches(e)));n&&n.receiveFromParent&&n.receiveFromParent(i,r)},findChild:e=>Array.from(t.children).find(e),findChildren:e=>Array.from(t.children).filter(e),findChildBySelector:e=>Array.from(t.children).find((t=>t.container.matches(e))),findChildByProperty:(e,i)=>Array.from(t.children).find((t=>t.abstraction&&t.abstraction[e]===i)),control:(e,i={})=>fetch(e,{method:i.method||"GET",headers:Object.assign({"Content-Type":"application/json","X-PAC-Request":"true"},i.headers||{}),body:i.data?JSON.stringify(i.data):void 0}).then((e=>e.json())).then((e=>(i.onSuccess&&i.onSuccess.call(t.abstraction,e),e))).catch((e=>{throw i.onError&&i.onError.call(t.abstraction,e),e})),destroy:()=>t.destroy()}),Object.entries(Object.getOwnPropertyDescriptors(e.abstraction)).forEach((([e,t])=>{"function"==typeof t.value?i.hasOwnProperty(e)||(i[e]=t.value.bind(i)):t.get||t.set?Object.defineProperty(i,e,{...t,get:t.get,set:t.set}):i[e]=t.value})),Object.defineProperties(i,{parent:{get:()=>t.parent,enumerable:!0},children:{get:()=>Array.from(t.children),enumerable:!0},container:{get:()=>t.container,enumerable:!0}}),i}(o.init(),o);return window.PACRegistry.register(t,o),o.establishHierarchy(),window.PACRegistry.units.forEach((e=>{e===o||e.parent||e.establishHierarchy()})),c}t.prototype={register(e,t){this.units.set(e,t),this.cache=new WeakMap},unregister(e){const t=this.units.get(e);return t&&(this.units.delete(e),this.cache=new WeakMap),t},getHierarchy(e){if(this.cache.has(e))return this.cache.get(e);let t=null,i=e.parentElement;const r=[];for(;i&&!t;)this.units.forEach((e=>{e.container===i&&(t=e)})),i=i.parentElement;this.units.forEach((t=>{e.contains(t.container)&&t.container!==e&&r.push(t)}));const n={parent:t,children:r};return this.cache.set(e,n),n}},window.PACRegistry=window.PACRegistry||new t,window.wakaPAC=r,"undefined"!=typeof module&&module.exports&&(module.exports={wakaPAC:r,PACRegistry:t,ReactiveUtils:e})}();
!function(){"use strict";const e=/\{\{\s*([^}]+)\s*}}/g,t=/\{\{.*}}/,n=/pac-foreach-item:\s*([^,]+),\s*index=(\d+),\s*renderIndex=(\d+)/,r=["readonly","required","selected","checked","hidden","multiple","autofocus"],i=["value","checked","visible","if","foreach","class","style","click","change","input","submit","focus","blur","keyup","keydown"],a={MSG_UNKNOWN:0,MSG_LBUTTONDOWN:513,MSG_LBUTTONUP:514,MSG_RBUTTONDOWN:516,MSG_RBUTTONUP:517,MSG_MBUTTONDOWN:519,MSG_MBUTTONUP:520,MSG_CHAR:768,MSG_CHANGE:769,MSG_SUBMIT:770,MSG_FOCUS:7,MSG_BLUR:8,MSG_KEYDOWN:256,MSG_KEYUP:257},o={uniqid:(e="",t=!1)=>`${e}${(1e3*Date.now()+1e3*Math.random()).toString(16).padEnd(14,"0")}${t?`.${Math.trunc(1e8*Math.random())}`:""}`,setNestedProperty(e,t,n){const r=e.split(/[.\[\]]+/).filter(Boolean);for(let e=0;e<r.length-1;e++){const t=r[e],i=r[e+1];t in n||(n[t]=/^\d+$/.test(i)?[]:{}),n=n[t]}n[r[r.length-1]]=t},getElementIdentifier:e=>e.id?e.id:(e.hasAttribute("data-pac-element-id")||e.setAttribute("data-pac-element-id",o.uniqid("pac-el-")),e.getAttribute("data-pac-element-id")),pathStringToArray:e=>Array.isArray(e)?e:String(e).split(/[.\[\]]+/).filter(Boolean),pathArrayToString(e){if(0===e.length)return"";let t=String(e[0]);for(let n=1;n<e.length;n++){const r=e[n];"number"==typeof r||/^\d+$/.test(String(r))?t+=`[${r}]`:t+=`.${r}`}return t},belongsToPacContainer(e,t){if(!(e instanceof Element&&e.hasAttribute("data-pac-container")))return!1;const n=t&&t.nodeType===Node.TEXT_NODE?t.parentElement:t;return n instanceof Element&&!!e.contains(n)&&n.closest("[data-pac-container]")===e},isElementVisible(e){const t=e.getBoundingClientRect(),n=window.innerHeight,r=window.innerWidth;return t.top<n&&t.bottom>0&&t.left<r&&t.right>0},isElementFullyVisible(e){const t=e.getBoundingClientRect(),n=window.innerHeight,r=window.innerWidth;return t.top>=0&&t.left>=0&&t.bottom<=n&&t.right<=r},isElementDirectlyFocused:e=>e===document.activeElement,isElementFocusWithin:e=>e===document.activeElement||e.contains(document.activeElement),getElementPosition(e){let t;if("string"==typeof e){const n=e.startsWith("#")?e.slice(1):e;t=document.getElementById(n)}else{if(!e||e.nodeType!==Node.ELEMENT_NODE)return null;t=e}if(!t)return null;const n=t.getBoundingClientRect(),r=window.scrollX||document.documentElement.scrollLeft||0,i=window.scrollY||document.documentElement.scrollTop||0;return{x:n.left+r,y:n.top+i}},domRectToSimpleObject:e=>({top:e.top,left:e.left,right:e.right,bottom:e.bottom,width:e.width,height:e.height,x:e.x,y:e.y}),getNetworkEffectiveType:()=>navigator.onLine?"connection"in navigator&&navigator.connection?.effectiveType?navigator.connection.effectiveType:"4g":"offline",readDOMValue:e=>{let t;if(t="string"!=typeof e?e&&e.nodeType?e:null:e.startsWith("#")?document.getElementById(e.slice(1)):document.querySelector(e),!t)return!1;switch(!0){case"SELECT"===t.tagName:return t.value;case"checkbox"===t.type:return t.checked;case"radio"===t.type:{const e=document.querySelector('input[name="'+t.name+'"]:checked');return e?e.value:""}case"INPUT"===t.tagName||"TEXTAREA"===t.tagName:return t.value;default:return t.textContent||t.innerText}},writeDOMValue:(e,t)=>{let n;if(n="string"!=typeof e?e&&e.nodeType?e:null:e.startsWith("#")?document.getElementById(e.slice(1)):document.querySelector(e),!n)return!1;switch(!0){case"SELECT"===n.tagName:return n.value=t,n.dispatchEvent(new Event("change",{bubbles:!0})),!0;case"checkbox"===n.type:return n.checked=Boolean(t),n.dispatchEvent(new Event("change",{bubbles:!0})),!0;case"radio"===n.type:{const e=document.querySelector('input[name="'+n.name+'"][value="'+t+'"]');return!!e&&(e.checked=!0,e.dispatchEvent(new Event("change",{bubbles:!0})),!0)}case"INPUT"===n.tagName||"TEXTAREA"===n.tagName:return n.value=t,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0})),!0;default:return n.textContent=t,!0}},isEqual(e,t){if(e===t)return!0;if(Number.isNaN(e)&&Number.isNaN(t))return!0;if(!e||!t||"object"!=typeof e||"object"!=typeof t)return!1;if(Array.isArray(e))return Array.isArray(t)&&e.length===t.length&&e.every((e,n)=>this.isEqual(e,t[n]));const n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every(n=>Object.hasOwn(t,n)&&this.isEqual(e[n],t[n]))},djb2Hash(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=4294967295;return(t>>>0).toString(16)}},s={_initialized:!1,initialize(){const e=this;if(this._initialized)return;let t,n;this._initialized=!0,document.addEventListener("visibilitychange",function(t){e.dispatchBrowserStateEvent("visibility",{visible:!document.hidden})}),window.addEventListener("online",function(t){e.dispatchBrowserStateEvent("online",{online:!0,networkType:o.getNetworkEffectiveType()})}),window.addEventListener("offline",function(t){e.dispatchBrowserStateEvent("online",{online:!1,networkType:"offline"})}),"connection"in navigator&&navigator.connection&&navigator.connection.addEventListener("change",function(t){e.dispatchBrowserStateEvent("online",{online:navigator.onLine,networkType:o.getNetworkEffectiveType()})}),document.addEventListener("focusin",function(t){e.dispatchFocusEvent("focusin",t)},!0),document.addEventListener("focusout",function(t){e.dispatchFocusEvent("focusout",t)},!0),document.addEventListener("mousedown",function(t){let n;if(0===t.button)n=a.MSG_LBUTTONDOWN;else if(1===t.button)n=a.MSG_MBUTTONDOWN;else{if(2!==t.button)return;n=a.MSG_RBUTTONDOWN}e.dispatchTrackedEvent(n,t)}),document.addEventListener("mouseup",function(t){let n;if(0===t.button)n=a.MSG_LBUTTONUP;else if(1===t.button)n=a.MSG_MBUTTONUP;else{if(2!==t.button)return;n=a.MSG_RBUTTONUP}e.dispatchTrackedEvent(n,t)}),document.addEventListener("keyup",function(t){e.dispatchTrackedEvent(a.MSG_KEYUP,t,{key:t.key,code:t.code})}),document.addEventListener("keydown",function(t){e.dispatchTrackedEvent(a.MSG_KEYDOWN,t)}),document.addEventListener("change",function(t){"SELECT"!==t.target.tagName&&"radio"!==t.target.type&&"checkbox"!==t.target.type||e.dispatchTrackedEvent(a.MSG_CHANGE,t,{elementType:"SELECT"===t.target.tagName?"select":t.target.type})}),document.addEventListener("input",function(t){("INPUT"===t.target.tagName&&!["radio","checkbox"].includes(t.target.type)||"TEXTAREA"===t.target.tagName)&&e.dispatchTrackedEvent(a.MSG_CHAR,t,{elementType:"TEXTAREA"===t.target.tagName?"textarea":"input"})}),document.addEventListener("submit",function(t){e.dispatchTrackedEvent(a.MSG_SUBMIT,t)}),window.addEventListener("scroll",function(n){t||(t=setTimeout(()=>{e.dispatchBrowserStateEvent("scroll",{scrollX:window.scrollX,scrollY:window.scrollY}),t=null},16))}),window.addEventListener("resize",function(t){n||(n=setTimeout(()=>{e.dispatchBrowserStateEvent("resize",{viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,documentWidth:document.documentElement.scrollWidth,documentHeight:document.documentElement.scrollHeight,scrollX:window.scrollX,scrollY:window.scrollY}),n=null},100))})},dispatchTrackedEvent(e,t,n={}){const r=t.target.closest("[data-pac-container]");if(!r)return;const i=this.buildParams(e,t),a=new CustomEvent("pac:event",{detail:{message:e,wParam:i.wParam,lParam:i.lParam,timestamp:Date.now(),target:t.target,id:t.target.id||null,value:o.readDOMValue(t.target),originalEvent:t,extended:n}});["preventDefault","stopPropagation","stopImmediatePropagation"].forEach(e=>{const n=a[e];a[e]=function(){n&&n.call(this),t[e]&&t[e].call(t)}}),r.dispatchEvent(a)},dispatchBrowserStateEvent(e,t){document.querySelectorAll("[data-pac-container]").forEach(n=>{const r=new CustomEvent("pac:browser-state",{detail:{target:n,stateType:e,stateData:t,timestamp:Date.now()}});n.dispatchEvent(r)})},dispatchFocusEvent(e,t){const n=document.querySelectorAll("[data-pac-container]"),{target:r,relatedTarget:i}=t;n.forEach(n=>{this.isContainerAffected(n,r,i)&&(n.dispatchEvent(new CustomEvent("pac:focus-state",{detail:{focusType:e,target:r,relatedTarget:i,containerFocus:o.isElementDirectlyFocused(n),containerFocusWithin:o.isElementFocusWithin(n),timestamp:Date.now()}})),o.belongsToPacContainer(n,r)&&this.isFormElement(r)&&("focusin"===e?this.dispatchTrackedEvent(a.MSG_FOCUS,t):"focusout"===e&&this.dispatchTrackedEvent(a.MSG_BLUR,t)))})},isContainerAffected(e,t,n){const r=e.contains(t)||e===t,i=n&&(e.contains(n)||e===n);return r||i},isFormElement:e=>"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName,buildParams(e,t){switch(e){case a.MSG_LBUTTONDOWN:case a.MSG_RBUTTONDOWN:case a.MSG_MBUTTONDOWN:case a.MSG_LBUTTONUP:case a.MSG_RBUTTONUP:case a.MSG_MBUTTONUP:return{wParam:this.buildMouseWParam(t),lParam:this.buildMouseLParam(t)};case a.MSG_KEYDOWN:case a.MSG_KEYUP:return{wParam:t.keyCode||t.which||0,lParam:this.buildKeyboardLParam(t)};case a.MSG_CHAR:return{wParam:t.target&&t.target.value?t.target.value.length:0,lParam:0};case a.MSG_CHANGE:return{wParam:this.buildChangeWParam(t),lParam:0};case a.MSG_SUBMIT:if(!t.target||void 0===t.target.elements)return{wParam:null,lParam:{}};try{const e=new FormData(t.target),n=Object.fromEntries(e.entries());return{wParam:t.target.id||null,lParam:n}}catch(e){return{wParam:t.target.id||null,lParam:{}}}default:return{wParam:0,lParam:0}}},buildMouseWParam(e){let t=0;return e.ctrlKey&&(t|=16),e.shiftKey&&(t|=8),e.altKey&&(t|=32),1&e.buttons&&(t|=1),2&e.buttons&&(t|=2),4&e.buttons&&(t|=4),t},buildMouseLParam(e){const t=Math.max(0,Math.min(65535,e.clientX||0));return Math.max(0,Math.min(65535,e.clientY||0))<<16|t},buildKeyboardLParam(e){let t=0;return t|=65535&(e.repeat?2:1),this.isExtendedKey(e.code)&&(t|=1<<24),"keyup"===e.type&&(t|=1<<31),t},buildChangeWParam(e){const t=e.target;switch(t.type){case"checkbox":return t.checked?1:0;case"radio":{const e=document.querySelectorAll(`input[name="${t.name}"]`);return Array.from(e).indexOf(t)}default:return"selectedIndex"in t?t.selectedIndex:0}},isExtendedKey:e=>!!e&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Home","End","PageUp","PageDown","Insert","Delete","NumpadEnter","NumpadDivide","MetaLeft","MetaRight","ContextMenu"].includes(e)},c={tokens:[],currentToken:0,OPERATOR_PRECEDENCE:{"||":1,"&&":2,"===":6,"!==":6,"==":6,"!=":6,"<":7,">":7,"<=":7,">=":7,"+":8,"-":8,"*":9,"/":9,"%":9,"!":10,"unary-":10,"unary+":10},OPERATOR_TYPES:{"||":"logical","&&":"logical","===":"comparison","!==":"comparison","==":"comparison","!=":"comparison",">=":"comparison","<=":"comparison",">":"comparison","<":"comparison","+":"arithmetic","-":"arithmetic","*":"arithmetic","/":"arithmetic","%":"arithmetic"},parseExpression(e){if("object"==typeof e&&null!==e){if(e.dependencies)return e;const t=this.extractDependencies(e);return Object.assign({},e,{dependencies:t})}if(e=String(e).trim(),this.tokens=this.tokenize(e),this.currentToken=0,0===this.tokens.length)return null;const t=this.parseTernary();return t&&(t.dependencies=this.extractDependencies(t)),t},tokenize(e){const t=[];let n=0;for(;n<e.length;){const r=e[n];if(/\s/.test(r)){n++;continue}if('"'===r||"'"===r){const r=this.tokenizeString(e,n);t.push(r.token),n=r.nextIndex;continue}if(/\d/.test(r)||"."===r&&/\d/.test(e[n+1])){const r=this.tokenizeNumber(e,n);t.push(r.token),n=r.nextIndex;continue}const i=/^(===|!==|==|!=|>=|<=|&&|\|\|)/.exec(e.slice(n));if(i){const e=i[1];t.push({type:"OPERATOR",value:e,precedence:this.getOperatorPrecedence(e)}),n+=e.length;continue}const a={"(":"LPAREN",")":"RPAREN","{":"LBRACE","}":"RBRACE","[":"LBRACKET","]":"RBRACKET",",":"COMMA",".":"DOT"};if(a[r])t.push({type:a[r],value:r}),n++;else{if("+-*/<>!?:%".includes(r)){const e=this.getOperatorPrecedence(r);let i;switch(r){case"?":i="QUESTION";break;case":":i="COLON";break;default:i="OPERATOR"}t.push({type:i,value:r,precedence:e}),n++;continue}if(/[a-zA-Z_$]/.test(r)){const r=this.tokenizeIdentifier(e,n);t.push(r.token),n=r.nextIndex;continue}n++}}return t},tokenizeString(e,t){const n=e[t];let r=t+1,i="";for(;r<e.length;){const t=e[r];if("\\"===t&&r+1<e.length){const a=e[r+1];a===n||"\\"===a?(i+=a,r+=2):(i+=t,r++)}else{if(t===n)return{token:{type:"STRING",value:i},nextIndex:r+1};i+=t,r++}}throw new Error(`Unterminated string literal starting at position ${t}: expected closing ${n}`)},tokenizeNumber(e,t){const n=/^(\d*\.?\d+(?:[eE][+-]?\d+)?)/.exec(e.slice(t));if(n)return{token:{type:"NUMBER",value:parseFloat(n[1])},nextIndex:t+n[1].length}},tokenizeIdentifier(e,t){const n=/^([a-zA-Z_$][a-zA-Z0-9_$]*)/.exec(e.slice(t));if(n){const e=n[1];return{token:{type:["true","false","null","undefined"].includes(e)?"KEYWORD":"IDENTIFIER",value:e},nextIndex:t+e.length}}},getOperatorPrecedence(e){return this.OPERATOR_PRECEDENCE[e]||0},parseTernary(){let e=this.parseBinaryWithPrecedence(1);if(this.match("QUESTION")){const t=this.parseTernary();return this.consume("COLON",'Expected ":" in ternary expression'),{type:"ternary",condition:e,trueValue:t,falseValue:this.parseTernary()}}return e},parseBinaryWithPrecedence(e){let t=this.parseUnary();for(;"OPERATOR"===this.peek().type;){const n=this.getOperatorPrecedence(this.peek().value);if(n<e)break;const r=this.advance().value,i=this.parseBinaryWithPrecedence(n+1);t={type:this.OPERATOR_TYPES[r]||"arithmetic",left:t,operator:r,right:i}}return t},parseUnary(){return this.matchOperator("!","-","+")?{type:"unary",operator:this.previous().value,operand:this.parseUnary()}:this.parsePrimary()},parsePrimary(){if(this.match("LPAREN")){const e=this.parseTernary();return this.consume("RPAREN","Expected closing parenthesis"),this.parsePostfixOperators({type:"parentheses",inner:e})}if(this.match("LBRACKET"))return this.parsePostfixOperators(this.parseArrayLiteral());if(this.match("LBRACE"))return this.parsePostfixOperators(this.parseObjectLiteral());if(this.check("STRING"))return this.parsePostfixOperators({type:"literal",value:this.advance().value});if(this.check("NUMBER"))return this.parsePostfixOperators({type:"literal",value:this.advance().value});if(this.check("KEYWORD")){let e;switch(this.advance().value){case"true":e=!0;break;case"false":e=!1;break;case"null":e=null;break;case"undefined":e=void 0}return this.parsePostfixOperators({type:"literal",value:e})}return this.check("IDENTIFIER")?this.parsePostfixOperators(this.parsePropertyAccess()):null},parsePostfixOperators(e){for(;;)if(this.match("LBRACKET")){const t=this.parseTernary();this.consume("RBRACKET","Expected closing bracket"),e={type:"index",object:e,index:t}}else{if(!this.match("DOT"))break;if(!this.check("IDENTIFIER"))throw new Error('Expected property name after "."');e={type:"member",object:e,property:this.advance().value}}return e},parseArrayLiteral(){const e=[];if(!this.check("RBRACKET"))do{e.push(this.parseTernary())}while(this.match("COMMA")&&!this.check("RBRACKET"));return this.consume("RBRACKET","Expected closing bracket"),{type:"array",elements:e}},parseObjectLiteral(){const e=[];if(!this.check("RBRACE"))do{let t;if(this.check("STRING"))t=this.advance().value;else{if(!this.check("IDENTIFIER"))throw new Error("Expected property name");t=this.advance().value}this.consume("COLON",'Expected ":" after object key');const n=this.parseTernary();e.push({key:t,value:n})}while(this.match("COMMA")&&!this.check("RBRACE"));return this.consume("RBRACE","Expected closing brace"),{type:"object",pairs:e}},parsePropertyAccess(){let e=this.advance().value;for(;;)if(this.match("DOT")){if(!this.check("IDENTIFIER"))throw new Error('Expected property name after "."');e+="."+this.advance().value}else{if(!this.match("LBRACKET"))break;{const t=this.parseTernary();this.consume("RBRACKET","Expected closing bracket"),"literal"===t.type?e+="["+JSON.stringify(t.value)+"]":e+="["+this.reconstructExpression(t)+"]"}}return{type:"property",path:e}},reconstructExpression(e){if(!e)return"";switch(e.type){case"literal":return"string"==typeof e.value?'"'+e.value+'"':String(e.value);case"property":return e.path;case"arithmetic":return`${this.reconstructExpression(e.left)} ${e.operator} ${this.reconstructExpression(e.right)}`;default:return"unknown"}},match(...e){for(const t of e)if(this.check(t))return this.advance(),!0;return!1},matchOperator(...e){if(this.check("OPERATOR")){const t=this.peek();if(e.includes(t.value))return this.advance(),!0}return!1},check(e){return!this.isAtEnd()&&this.peek().type===e},advance(){return this.isAtEnd()||this.currentToken++,this.previous()},isAtEnd(){return this.currentToken>=this.tokens.length},peek(){return this.tokens[this.currentToken]||{type:"EOF",value:null}},previous(){return this.tokens[this.currentToken-1]},consume(e,t){if(this.check(e))return this.advance();throw new Error(t+` at token: ${JSON.stringify(this.peek())}`)},evaluate(e,t,n=null){if(e)switch(e.type){case"literal":return e.value;case"property":return this.getProperty(e.path,t,n);case"parentheses":return this.evaluate(e.inner,t,n);case"array":return this.evaluateArrayLiteral(e,t,n);case"object":return this.evaluateObjectLiteral(e,t,n);case"index":{const r=this.evaluate(e.object,t,n),i=this.evaluate(e.index,t,n);return r&&r[i]}case"member":{const r=this.evaluate(e.object,t,n);return r&&r[e.property]}case"ternary":return this.evaluate(e.condition,t,n)?this.evaluate(e.trueValue,t,n):this.evaluate(e.falseValue,t,n);case"logical":{const r=this.evaluate(e.left,t,n);return"&&"===e.operator?!!r&&this.evaluate(e.right,t,n):"||"===e.operator&&(!!r||this.evaluate(e.right,t,n))}case"comparison":case"arithmetic":{const r=this.evaluate(e.left,t,n),i=this.evaluate(e.right,t,n);return this.performOperation(r,e.operator,i)}case"unary":{const r=this.evaluate(e.operand,t,n);switch(e.operator){case"!":return!r;case"-":return-r;case"+":return+r;default:return r}}default:return}},getProperty(e,t,n=null){if(!t||!e)return;let r=e;if(n&&n.resolveScopedPath&&(r=n.resolveScopedPath(e)),"number"==typeof r)return r;if(r=String(r),-1===r.indexOf(".")&&-1===r.indexOf("["))return r in t?t[r]:void 0;const i=r.split(/[.\[\]]+/).filter(Boolean);let a=t;for(let e=0;e<i.length;e++){if(null==a)return;a=a[i[e]]}return a},evaluateArrayLiteral(e,t,n=null){return e.elements?e.elements.map(e=>this.evaluate(e,t,n)):[]},evaluateObjectLiteral(e,t,n=null){const r={};return e.pairs&&e.pairs.forEach(({key:e,value:i})=>{r[e]=this.evaluate(i,t,n)}),r},performOperation(e,t,n){switch(t){case"+":return e+n;case"-":return Number(e)-Number(n);case"*":return Number(e)*Number(n);case"/":return Number(e)/Number(n);case"%":return Number(e)%Number(n);case"===":return e===n;case"!==":return e!==n;case"==":return e==n;case"!=":return e!=n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n;default:return!1}},extractDependencies(e){if(!e)return[];const t=new Set,n=e=>{if(e)switch(e.type){case"property":{const n=e.path.split(/[.[]/,1)[0];n&&!["true","false","null","undefined"].includes(n)&&t.add(n);break}case"array":e.elements&&e.elements.forEach(e=>n(e));break;case"index":n(e.object),n(e.index);break;case"member":n(e.object);break;case"ternary":n(e.condition),n(e.trueValue),n(e.falseValue);break;case"logical":case"comparison":case"arithmetic":n(e.left),n(e.right);break;case"unary":n(e.operand);break;case"parentheses":n(e.inner);break;case"object":e.pairs&&e.pairs.forEach(e=>n(e.value))}};return n(e),Array.from(t)},parseBindingString(e){const t=[];let n="",r=!1,i="",a=0,o=0,s=0;for(let c=0;c<e.length;c++){const h=e[c],l=c>0&&"\\"===e[c-1];'"'!==h&&"'"!==h||l||(r?h===i&&(r=!1,i=""):(r=!0,i=h)),r||("("===h?a++:")"===h?a--:"{"===h?o++:"}"===h?o--:"["===h?s++:"]"===h&&s--),","!==h||r||0!==a||0!==o||0!==s?n+=h:(this.addBindingPairIfValid(n,t),n="")}return this.addBindingPairIfValid(n,t),t},addBindingPairIfValid(e,t){const n=e.trim();if(!n)return;const r=this.findBindingColon(n);-1===r?t.push({type:n,target:""}):t.push({type:n.substring(0,r).trim(),target:n.substring(r+1).trim()})},findBindingColon(e){for(const t of i)if(e.startsWith(t+":"))return t.length;let t=!1,n="",r=0,a=0,o=0;for(let i=0;i<e.length;i++){const s=e[i],c=i>0&&"\\"===e[i-1];if('"'!==s&&"'"!==s||c||(t?s===n&&(t=!1,n=""):(t=!0,n=s)),!t)if("("===s)r++;else if(")"===s)r--;else if("["===s)a++;else if("]"===s)a--;else if("{"===s)o++;else if("}"===s)o--;else if(":"===s&&0===r&&0===a&&0===o)return i}return-1}},h={cache:new Map,bindingCache:new Map,maxSize:1e3,parseExpression(e){const t=String(e).trim();if(this.cache.has(t))return this.cache.get(t);const n=c.parseExpression(e);if(this.cache.size>=this.maxSize){const e=this.cache.keys().next().value;this.cache.delete(e)}return this.cache.set(t,n),n},parseBindingString(e){const t=String(e).trim();if(this.bindingCache.has(t))return this.bindingCache.get(t);const n=c.parseBindingString(e);if(this.bindingCache.size>=this.maxSize){const e=this.bindingCache.keys().next().value;this.bindingCache.delete(e)}return this.bindingCache.set(t,n),n},clear(){this.cache.clear(),this.bindingCache.clear()}};function l(e){this.context=e}function d(e,t,n){const r=this;if(this.originalAbstraction=t,this.parent=null,this.children=new Set,this.container=e,this.config=n,this.abstraction=this.createReactiveAbstraction(),this.domUpdater=new l(this),this.dependencies=this.getDependencies(),this.interpolationMap=new Map,this.textInterpolationMap=new Map,this.arrayHashMaps=new Map,this.setupContainerScrollTracking(),this.setupIntersectionObserver(),this.updateQueue=new Map,this.updateQueueCallback=function(){r.updateQueueHandler()},this.updateQueueInterval=setInterval(this.updateQueueCallback,10),this.boundHandlePacEvent=function(e){r.handleEvent(e)},this.container.addEventListener("pac:event",this.boundHandlePacEvent),this.container.addEventListener("pac:change",this.boundHandlePacEvent),this.container.addEventListener("pac:array-change",this.boundHandlePacEvent),this.container.addEventListener("pac:browser-state",this.boundHandlePacEvent),this.container.addEventListener("pac:focus-state",this.boundHandlePacEvent),this.abstraction.init&&"function"==typeof this.abstraction.init)try{this.abstraction.init.call(this.abstraction)}catch(e){}}function p(){this.components=new Map,this.hierarchyCache=new WeakMap}l.prototype.updateTextNode=function(t,n){const r=this,i=n.replace(e,(e,n)=>{try{const e=h.parseExpression(n),i={resolveScopedPath:e=>r.context.normalizePath(e,t)},a=c.evaluate(e,r.context.abstraction,i);return null!=a?String(a):""}catch(t){return e}});t.textContent!==i&&(t.textContent=i)},l.prototype.updateAttributeBinding=function(e,t,n){try{const r=h.parseExpression(n.target),i={resolveScopedPath:t=>this.context.normalizePath(t,e)},a=c.evaluate(r,this.context.abstraction,i);switch(t){case"value":this.applyValueBinding(e,a);break;case"checked":this.applyCheckedBinding(e,a);break;case"visible":this.applyVisibleBinding(e,a);break;case"if":this.applyConditionalBinding(e,a);break;case"class":this.applyClassBinding(e,a);break;case"style":this.applyStyleBinding(e,a);break;default:this.applyAttributeBinding(e,t,a)}}catch(e){}},l.prototype.applyValueBinding=function(e,t){if("radio"!==e.type){if("value"in e){const n=String(t||"");e.value!==n&&(e.value=n)}}else e.checked=e.value===String(t)},l.prototype.applyCheckedBinding=function(e,t){if("checkbox"===e.type||"radio"===e.type){const n=Boolean(t);e.checked!==n&&(e.checked=n)}},l.prototype.applyVisibleBinding=function(e,t){if(t)e.hasAttribute("data-pac-hidden")&&(e.style.display=e.getAttribute("data-pac-orig-display")||"",e.removeAttribute("data-pac-hidden"),e.removeAttribute("data-pac-orig-display"));else if(!e.hasAttribute("data-pac-hidden")){const t=getComputedStyle(e).display;"none"!==t&&e.setAttribute("data-pac-orig-display",t),e.style.display="none",e.setAttribute("data-pac-hidden","true")}},l.prototype.applyConditionalBinding=function(e,t){const n=!!t;if(e._pacPlaceholder||(e._pacPlaceholder=document.createComment("pac-if: hidden"),e._pacOriginalParent=e.parentNode,e._pacOriginalNextSibling=e.nextSibling,e._pacIsRendered=!0),n&&!e._pacIsRendered)return e._pacPlaceholder.parentNode&&(e._pacOriginalParent=e._pacPlaceholder.parentNode,e._pacOriginalNextSibling=e._pacPlaceholder.nextSibling,e._pacPlaceholder.parentNode.replaceChild(e,e._pacPlaceholder)),void(e._pacIsRendered=!0);!n&&e._pacIsRendered&&(e.parentNode&&e.parentNode.replaceChild(e._pacPlaceholder,e),e._pacIsRendered=!1)},l.prototype.applyClassBinding=function(e,t){"object"!=typeof t||null===t?"string"==typeof t&&(e._pacDynamicClass&&e.classList.remove(e._pacDynamicClass),e.classList.add(t),e._pacDynamicClass=t):Object.keys(t).forEach(n=>{t[n]?e.classList.add(n):e.classList.remove(n)})},l.prototype.applyStyleBinding=function(e,t){if("object"!=typeof t||null===t||Array.isArray(t))"string"==typeof t&&(e.style.cssText=t);else for(const n in t)null!=t[n]&&(n.startsWith("--")?e.style.setProperty(n,t[n]):e.style[n]=t[n])},l.prototype.applyAttributeBinding=function(e,t,n){"enable"===t?e.toggleAttribute("disabled",!n):r.includes(t)?e.toggleAttribute(t,!!n):null!=n?e.setAttribute(t,n):e.removeAttribute(t)},d.prototype.destroy=function(){clearInterval(this.updateQueueInterval),this.updateQueueCallback=null,this.container.removeEventListener("pac:event",this.boundHandlePacEvent),this.container.removeEventListener("pac:change",this.boundHandlePacEvent),this.container.removeEventListener("pac:array-change",this.boundHandlePacEvent),this.container.removeEventListener("pac:browser-state",this.boundHandlePacEvent),this.container.removeEventListener("pac:focus-state",this.boundHandlePacEvent),this.boundHandlePacEvent=null,this.containerScrollHandler&&(clearTimeout(this.scrollTimeout),this.container.removeEventListener("scroll",this.containerScrollHandler),this.containerScrollHandler=null),this.intersectionObserver&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null),this.interpolationMap.clear(),this.textInterpolationMap.clear(),this.arrayHashMaps.clear(),this.updateQueue.clear()},d.prototype.setupContainerScrollTracking=function(){requestAnimationFrame(()=>this.updateContainerScrollState());const e=()=>{clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.updateContainerScrollState()},16)};this.container.addEventListener("scroll",e,{passive:!0}),this.containerScrollHandler=e},d.prototype.updateContainerScrollState=function(){const e=this.container.scrollLeft,t=this.container.scrollTop,n=this.container.clientWidth,r=this.container.clientHeight,i=this.container.scrollWidth,a=this.container.scrollHeight,o=i>this.abstraction.containerWidth||a>this.abstraction.containerHeight;this.abstraction.containerScrollX=e,this.abstraction.containerScrollY=t,this.abstraction.containerScrollContentWidth=i,this.abstraction.containerScrollContentHeight=a,this.abstraction.containerIsScrollable=o,Object.assign(this.abstraction.containerScrollWindow,{top:t,left:e,right:e+n,bottom:t+r,x:e,y:t})},d.prototype.setupIntersectionObserver=function(){this.intersectionObserver=new IntersectionObserver(e=>{e.forEach(e=>{if(e.target===this.container){const t=e.boundingClientRect,n=e.isIntersecting,r=e.intersectionRatio>=.99;this.abstraction.containerVisible=n,this.abstraction.containerFullyVisible=r,this.abstraction.containerWidth=t.width,this.abstraction.containerHeight=t.height,this.abstraction.containerClientRect=o.domRectToSimpleObject(t)}})},{threshold:[0,1]}),this.intersectionObserver.observe(this.container)},d.prototype.updateContainerVisibility=function(){const e=o.domRectToSimpleObject(this.container.getBoundingClientRect());this.abstraction.containerClientRect=e,this.abstraction.containerWidth=e.width,this.abstraction.containerHeight=e.height,this.abstraction.containerVisible=o.isElementVisible(this.container),this.abstraction.containerFullyVisible=o.isElementFullyVisible(this.container)},d.prototype.scanAndRegisterNewElements=function(e){const t=this,n=this.scanBindings(e),r=this.scanTextBindings(e);n.forEach((t,n)=>{n!==e&&this.interpolationMap.set(n,t)}),r.forEach((e,t)=>{this.textInterpolationMap.set(t,e)}),n.forEach((t,n)=>{const{bindings:r}=t;if(r.foreach&&n!==e){const e=o.uniqid("foreach");n.setAttribute("data-pac-foreach-id",e);const i=r.foreach.target,a=this.inferArrayRoot(i);n.setAttribute("data-pac-array",a);const s=n.getAttribute("data-pac-item")||"item",c=n.getAttribute("data-pac-index")||"index";Object.assign(t,{foreachExpr:r.foreach.target,sourceArray:a,foreachId:e,template:n.innerHTML,itemVar:s,indexVar:c})}}),n.forEach((e,n)=>{Object.keys(e.bindings).forEach(r=>{const i=e.bindings[r];t.domUpdater.updateAttributeBinding(n,r,i)})}),r.forEach((e,n)=>{t.domUpdater.updateTextNode(n,e.template)}),Array.from(n.entries()).filter(([t,n])=>n.bindings.foreach&&t!==e).sort(([,e],[,t])=>{const n=e.depth;return t.depth-n}).forEach(([e])=>{this.renderForeach(e)})},d.prototype.getDependencies=function(){const e=new Map,t=this.originalAbstraction.computed||{},n=new Set,r=new Proxy(this.originalAbstraction,{get:(e,t)=>("string"==typeof t&&n.add(t),e[t])});return Object.keys(t).forEach(i=>{n.clear(),t[i].call(r),n.forEach(t=>{e.has(t)||e.set(t,[]),e.get(t).push(i)})}),e},d.prototype.inferArrayRoot=function(e){for(const[t,n]of this.dependencies){const r=this.abstraction[t],i=Array.isArray(r);if(n.includes(e)&&i)return t}return e},d.prototype.handleAttributeChanges=function(e,t){const n=this,r=e.detail.path[0];this.interpolationMap.forEach((i,a)=>{const{bindings:o}=i;Object.keys(o).forEach(i=>{if(["foreach","click"].includes(i))return;const s=o[i];let c=s.dependencies.some(n=>t.includes(n)||e.detail.path.join(".").startsWith(n+".")||e.detail.path.join(".").startsWith(n+"["));if(!c){const e=a.closest("[data-pac-foreach-id]");if(e){const t=n.interpolationMap.get(e);t&&t.sourceArray===r&&(c=!0)}}c&&n.domUpdater.updateAttributeBinding(a,i,s)})})},d.prototype.handleTextInterpolation=function(e,t){const n=this,r=e.detail.path[0];n.textInterpolationMap.forEach((i,a)=>{let o=i.dependencies.some(n=>{const r=t.includes(n),i=e.detail.path.join(".").startsWith(n+".")||e.detail.path.join(".").startsWith(n+"[");return r||i});if(!o){const e=a.parentElement?.closest("[data-pac-foreach-id]");if(e){const t=n.interpolationMap.get(e);t&&t.sourceArray===r&&(o=!0)}}o&&n.domUpdater.updateTextNode(a,i.template)})},d.prototype.updateQueueHandler=function(){if(0===this.updateQueue.size)return;const e=Date.now(),t=[],n=[];this.updateQueue.forEach((r,i)=>{"delay"===r.trigger&&e>=r.executeAt&&(t.push({path:i,value:r.value,trigger:r.trigger}),n.push(i))}),t.forEach(e=>{try{o.setNestedProperty(e.path,e.value,this.abstraction)}catch(e){}}),n.forEach(e=>{this.updateQueue.delete(e)}),t.length},d.prototype.processBlurQueueUpdates=function(e){const t=o.getElementIdentifier(e),n=[];this.updateQueue.forEach((e,r)=>{"blur"===e.trigger&&e.elementId===t&&n.push({path:r,value:e.value})}),n.forEach(e=>{try{o.setNestedProperty(e.path,e.value,this.abstraction),this.updateQueue.delete(e.path)}catch(t){this.updateQueue.delete(e.path)}})},d.prototype.getUpdateConfiguration=function(e){const t=e.getAttribute("data-pac-update-mode")||this.config.updateMode||"immediate",n=parseInt(e.getAttribute("data-pac-update-delay"))||this.config.delay||300;return{updateMode:t,delay:Math.min(n,3e3)}},d.prototype.handleEvent=function(e){switch(e.type){case"pac:event":this.handlePacEvent(e);break;case"pac:array-change":this.handleArrayChange(e);break;case"pac:change":this.handleReactiveChange(e);break;case"pac:browser-state":this.handleBrowserState(e);break;case"pac:focus-state":this.handleFocusState(e)}},d.prototype.handlePacEvent=function(e){let t=!0;if(this.originalAbstraction.msgProc&&"function"==typeof this.originalAbstraction.msgProc){const n=this.originalAbstraction.msgProc.call(this.abstraction,e);[a.MSG_LBUTTONUP,a.MSG_MBUTTONUP,a.MSG_RBUTTONUP,a.MSG_SUBMIT,a.MSG_CHANGE].includes(e.detail.message)&&!1===n&&(t=!1)}if(t)switch(e.detail.message){case a.MSG_LBUTTONDOWN:case a.MSG_MBUTTONDOWN:case a.MSG_RBUTTONDOWN:case a.MSG_KEYUP:case a.MSG_KEYDOWN:break;case a.MSG_LBUTTONUP:case a.MSG_MBUTTONUP:case a.MSG_RBUTTONUP:this.handleDomClicks(e);break;case a.MSG_SUBMIT:this.handleDomSubmit(e);break;case a.MSG_CHANGE:this.handleDomChange(e);break;case a.MSG_CHAR:this.handleDomInput(e);break;case a.MSG_FOCUS:this.handleDomFocus(e);break;case a.MSG_BLUR:this.handleDomBlur(e)}else e.preventDefault()},d.prototype.handleDomClicks=function(e){const t=this.interpolationMap.get(e.detail.target);if(!t?.bindings?.click)return;const n=this.abstraction[t.bindings.click.target];if("function"==typeof n)try{const t=this.extractClosestForeachContext(e.detail.target);if(!t)return void n.call(this.abstraction,e);const r=Array.from(this.interpolationMap.entries()).find(([,e])=>e.foreachId===t.foreachId)?.[0];if(!r)return void n.call(this.abstraction,e);const i=this.interpolationMap.get(r),a={resolveScopedPath:t=>this.normalizePath(t,e.detail.target)},o=c.evaluate(h.parseExpression(i.foreachExpr),this.abstraction,a);n.call(this.abstraction,o[t.index],t.index,e)}catch(e){}},d.prototype.handleDomSubmit=function(e){const t=this.interpolationMap.get(e.detail.target);if(!t?.bindings?.submit)return;const n=this.abstraction[t.bindings.submit.target];if("function"==typeof n)try{n.call(this.abstraction,e)}catch(e){}},d.prototype.handleDomChange=function(e){const t=this,n=e.detail.target,r=this.interpolationMap.get(n);if(r){if(r.bindings.value){const i=r.bindings.value,a=t.normalizePath(i.target,n);o.setNestedProperty(a,e.detail.value,this.abstraction)}if(r.bindings.checked){const i=r.bindings.checked,a=t.normalizePath(i.target,n);"checkbox"===n.type?o.setNestedProperty(a,e.detail.target.checked,this.abstraction):"radio"===n.type&&e.detail.target.checked&&o.setNestedProperty(a,e.detail.value,this.abstraction)}if(r.bindings.change){const t=this.abstraction[r.bindings.change.target];if("function"==typeof t)try{t.call(this.abstraction,e)}catch(e){}}}},d.prototype.handleDomInput=function(e){const t=this,n=e.detail.target,r=this.interpolationMap.get(n);if(r&&r.bindings.value){const i=r.bindings.value,a=t.normalizePath(i.target,n),s=this.getUpdateConfiguration(n);switch(s.updateMode){case"immediate":o.setNestedProperty(a,e.detail.value,this.abstraction);break;case"delayed":this.updateQueue.set(a,{trigger:"delay",value:e.detail.value,executeAt:Date.now()+s.delay});break;case"change":this.updateQueue.set(a,{trigger:"blur",value:e.detail.value,elementId:o.getElementIdentifier(n)})}}},d.prototype.handleDomFocus=function(e){const t=e.detail.target;this.interpolationMap.get(t)},d.prototype.handleDomBlur=function(e){const t=e.detail.target;this.interpolationMap.get(t)&&this.processBlurQueueUpdates(t)},d.prototype.handleReactiveChange=function(e){const t=o.pathArrayToString(e.detail.path),n=[t];1===e.detail.path.length&&this.triggerWatcher(t,e.detail.newValue,e.detail.oldValue),this.dependencies.has(t)&&n.push(...this.dependencies.get(t));const r=e.detail.path[0];this.dependencies.has(r)&&n.push(...this.dependencies.get(r)),this.handleTextInterpolation(e,n),this.handleAttributeChanges(e,n),n.forEach(n=>{if(n===t&&e.detail.path.length>1)return;const r="function"==typeof this.abstraction.computed?.[n],i=1===e.detail.path.length&&Array.isArray(this.abstraction[n]);(r||i)&&this.findForeachElementsByArrayPath(n).forEach(e=>{this.shouldRebuildForeach(e)&&this.renderForeach(e)})})},d.prototype.triggerWatcher=function(e,t,n){if(this.originalAbstraction.watch&&this.originalAbstraction.watch[e]&&"function"==typeof this.originalAbstraction.watch[e])try{this.originalAbstraction.watch[e].call(this.abstraction,t,n)}catch(e){}},d.prototype.handleBrowserState=function(e){const{stateType:t,stateData:n}=e.detail;switch(t){case"visibility":this.abstraction.browserVisible=n.visible;break;case"online":this.abstraction.browserOnline=n.online,this.abstraction.browserNetworkEffectiveType=n.networkType;break;case"scroll":this.abstraction.browserScrollX=n.scrollX,this.abstraction.browserScrollY=n.scrollY;break;case"resize":this.abstraction.browserViewportWidth=n.viewportWidth,this.abstraction.browserViewportHeight=n.viewportHeight,this.abstraction.browserDocumentWidth=n.documentWidth,this.abstraction.browserDocumentHeight=n.documentHeight,this.abstraction.browserScrollX=n.scrollX,this.abstraction.browserScrollY=n.scrollY,this.updateContainerVisibility()}},d.prototype.handleFocusState=function(e){this.abstraction.containerFocus=e.detail.containerFocus,this.abstraction.containerFocusWithin=e.detail.containerFocusWithin},d.prototype.handleArrayChange=function(e){const t=o.pathArrayToString(e.detail.path);this.findForeachElementsByArrayPath(t).forEach(n=>{const r=this.arrayHashMaps.get(t)||new Map,i=this.classifyArrayChanges(r,e.detail.newValue);this.canHandleSimply(i)?this.handleSimpleArrayChange(n,i,e.detail.newValue,t):this.renderForeach(n)})},d.prototype.scanBindings=function(e){const t=this,n=new Map;return e.querySelectorAll("[data-pac-bind]").forEach(e=>{if(n.has(e))return;if(!o.belongsToPacContainer(t.container,e))return;const r=e.getAttribute("data-pac-bind"),i=h.parseBindingString(r),a={};i.forEach(e=>{a[e.type]={target:e.target,dependencies:this.extractDependencies(e.target)}});const s={bindingString:r,bindings:a};n.set(e,s)}),n},d.prototype.scanTextBindings=function(e){const n=new Map,r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>t.test(e.textContent)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let i;for(;i=r.nextNode();)n.has(i)||o.belongsToPacContainer(this.container,i)&&n.set(i,{template:i.textContent,dependencies:this.extractInterpolationDependencies(i.textContent)});return n},d.prototype.extractInterpolationDependencies=function(t){const n=new Set;return t.replace(e,(e,t)=>(this.extractDependencies(t.trim()).forEach(e=>n.add(e)),e)),Array.from(n)},d.prototype.extractDependencies=function(e){try{const t=h.parseExpression(e);return t?.dependencies||[]}catch(e){return[]}},d.prototype.createReactiveAbstraction=function(){const e=this;this.injectHierarchyProperties(this.originalAbstraction),this.injectSystemProperties(this.originalAbstraction);const t=function(e,t){const n=["push","pop","shift","unshift","splice","sort","reverse"];return e&&"object"==typeof e?function e(r,i){return i=i||[],new Proxy(r,{get:function(r,a){const o=r[a];if(Array.isArray(r)&&"function"==typeof o&&n.includes(a))return function(){const n=Array.prototype.slice.call(r),o=Array.prototype[a].apply(r,arguments),s=Array.prototype.slice.call(r);s.forEach((t,n)=>{if(t&&"object"==typeof t&&!t._isReactive){const r=i.concat([n]);s[n]=e(t,r),s[n]._isReactive=!0}});for(let e=0;e<s.length;e++)r[e]=s[e];return t.dispatchEvent(new CustomEvent("pac:array-change",{detail:{path:i,oldValue:n,newValue:r,method:a}})),t.dispatchEvent(new CustomEvent("pac:change",{detail:{path:i,oldValue:n,newValue:r}})),o};const s=Object.getOwnPropertyDescriptor(r,a);if(s&&s.get&&!s.set)return o;if("function"==typeof o)return o;if(o&&"object"==typeof o&&!o._isReactive){const t=e(o,i.concat([a]));return t._isReactive=!0,r[a]=t,t}return o},set:function(n,r,a){const o=n[r],s=i.concat([r]);return o===a||(1===s.length&&("containerScrollX"===r&&t?t.scrollLeft=a:"containerScrollY"===r&&t?t.scrollTop=a:"browserScrollX"===r?window.scrollTo(a,window.scrollY):"browserScrollY"===r&&window.scrollTo(window.scrollX,a)),a&&"object"==typeof a?(n[r]=e(a,s),n[r]._isReactive=!0):n[r]=a,Array.isArray(a)&&t.dispatchEvent(new CustomEvent("pac:array-change",{detail:{path:s,oldValue:o,newValue:n[r],method:"assignment"}})),t.dispatchEvent(new CustomEvent("pac:change",{detail:{path:s,oldValue:o,newValue:n[r]}}))),!0}})}(e,[]):e}(this.originalAbstraction,this.container);Object.keys(this.originalAbstraction).forEach(function(n){"function"==typeof e.originalAbstraction[n]&&"computed"!==n&&(t[n]=e.originalAbstraction[n].bind(t))});const n=this.originalAbstraction.computed||{};return Object.keys(n).forEach(function(e){Object.defineProperty(t,e,{get:function(){return n[e].call(t)},enumerable:!0,configurable:!0})}),Object.assign(t,{notifyParent:(t,n)=>{e.parent&&"function"==typeof e.parent.receiveUpdate&&e.parent.receiveUpdate(t,n,e)},notifyChildren:(t,n)=>{e.children.forEach(e=>{"function"==typeof e.receiveFromParent&&e.receiveFromParent(t,n)})},notifyChild:(t,n,r)=>{const i=Array.from(e.children).find(e=>e.container.matches(t));i&&i.receiveFromParent&&i.receiveFromParent(n,r)}}),t},d.prototype.injectHierarchyProperties=function(e){e.childrenCount=0,e.hasParent=!1},d.prototype.injectSystemProperties=function(e){e.browserOnline=navigator.onLine,e.browserNetworkEffectiveType=o.getNetworkEffectiveType(),e.browserVisible=!document.hidden,e.browserScrollX=window.scrollX,e.browserScrollY=window.scrollY,e.browserViewportHeight=window.innerHeight,e.browserViewportWidth=window.innerWidth,e.browserDocumentWidth=document.documentElement.scrollWidth,e.browserDocumentHeight=document.documentElement.scrollHeight,e.containerIsScrollable=!1,e.containerScrollX=this.container.scrollLeft,e.containerScrollY=this.container.scrollTop,e.containerScrollContentWidth=this.container.scrollWidth,e.containerScrollContentHeight=this.container.scrollHeight,e.containerScrollWindow={top:0,left:0,right:0,bottom:0,x:0,y:0},e.containerFocus=o.isElementDirectlyFocused(this.container),e.containerFocusWithin=o.isElementFocusWithin(this.container),e.containerVisible=o.isElementVisible(this.container),e.containerFullyVisible=o.isElementFullyVisible(this.container),e.containerClientRect={top:0,left:0,right:0,bottom:0,width:0,height:0,x:0,y:0},e.containerWidth=this.container.clientWidth,e.containerHeight=this.container.clientHeight},d.prototype.findParentForeachElement=function(e){let t=e.parentElement;for(;t&&t!==this.container;){if(t.hasAttribute("data-pac-bind")&&t.getAttribute("data-pac-bind").includes("foreach:"))return t;t=t.parentElement}return null},d.prototype.renderForeach=function(e){const t=this,n=this.interpolationMap.get(e);if(!n||!n.foreachId)return;const r=n.sourceArray;this.cleanupForeachMaps(e);const i={resolveScopedPath:t=>this.normalizePath(t,e)};try{const a=c.evaluate(h.parseExpression(n.foreachExpr),this.abstraction,i);if(!a)return;if(!Array.isArray(a))return void(e.innerHTML="");const o=this.getSourceArrayForFiltered(n.foreachExpr,a),s=t.arrayHashMaps.get(r)||new Map;s.clear(),e._pacPreviousArray=a;let l="";a.forEach((e,r)=>{const i=t.findOriginalIndex(e,o,r),a=t.createForeachEntryHash(e,i);s.set(a,i),l+=`\x3c!-- pac-foreach-item: ${n.foreachId}, index=${i}, renderIndex=${r} --\x3e`+n.template+"\x3c!-- /pac-foreach-item --\x3e"}),e.innerHTML=l,this.arrayHashMaps.set(r,s),this.scanAndRegisterNewElements(e)}catch(e){}},d.prototype.getSourceArrayForFiltered=function(e,t){if(this.originalAbstraction.computed&&this.originalAbstraction.computed[e]){const t=this.dependencies.get(e)||[];for(const e of t){const t=this.abstraction[e];if(Array.isArray(t))return t}}return Array.isArray(this.abstraction[e])?this.abstraction[e]:t},d.prototype.findOriginalIndex=function(e,t,n){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e)return n;for(let n=0;n<t.length;n++)if(t[n]===e)return n;if(e&&"object"==typeof e&&void 0!==e.id)for(let n=0;n<t.length;n++){const r=t[n];if(r&&"object"==typeof r&&r.id===e.id)return n}for(let n=0;n<t.length;n++)if(o.isEqual(t[n],e))return n;return n},d.prototype.getForeachChain=function(e){const t=[];let n=e;for(;null!=n;){const e=this.extractClosestForeachContext(n);if(e){const n=this.container.querySelector('[data-pac-foreach-id="'+e.foreachId+'"]'),r=this.interpolationMap.get(n);r&&t.push({foreachId:e.foreachId,depth:r.depth,index:e.index,renderIndex:e.renderIndex,container:n,itemVar:r.itemVar,indexVar:r.indexVar,sourceArray:r.sourceArray})}n=this.findParentForeachElement(n)}return t},d.prototype.normalizePath=function(e,t){const n=o.pathStringToArray(e);if(!n.length)return"";let r=0;for(;r<n.length&&"parent"===n[r];)r++;const i=this.getForeachChain(t);r>i.length&&(r=i.length);const a=i.slice(r),s=new Map;for(const e of a){if(!s.has(e.itemVar)){const t=s.get(e.sourceArray)||e.sourceArray;s.set(e.itemVar,`${t}[${e.index}]`)}e.indexVar&&!s.has(e.indexVar)&&s.set(e.indexVar,e.index)}const c=n.slice(r);if(!c.length)return"";const h=[];for(let e=0;e<c.length;e++){const t=c[e];if(s.has(t)){const e=s.get(t);if("number"==typeof e)h.push(e);else{const t=e.split(/[.\[\]]+/).filter(Boolean);h.push(...t)}}else h.push(t)}return 1===h.length&&"number"==typeof h[0]?h[0]:o.pathArrayToString(h)},d.prototype.shouldRebuildForeach=function(e){const t=this.interpolationMap.get(e);if(!t)return!1;const n={resolveScopedPath:t=>this.normalizePath(t,e)},r=c.evaluate(h.parseExpression(t.foreachExpr),this.abstraction,n);if(!Array.isArray(r))return!1;const i=e._pacPreviousArray;if(!i)return!0;if(r.length!==i.length)return!0;for(let e=0;e<r.length;e++)if(r[e]!==i[e])return!0;return!1},d.prototype.findForeachElementsByArrayPath=function(e){const t=[];for(const[n,r]of this.interpolationMap)r.bindings&&r.bindings.foreach&&(r.foreachExpr!==e&&r.sourceArray!==e||t.push(n));return t},d.prototype.extractClosestForeachContext=function(e){let t=e;for(;t&&t!==this.container;){let e=t.previousSibling;for(;e;){if(e.nodeType===Node.COMMENT_NODE){const t=e.textContent.trim().match(n);if(t)return{foreachId:t[1].trim(),index:parseInt(t[2],10),renderIndex:parseInt(t[3],10)}}e=e.previousSibling}t=t.parentElement}return null},d.prototype.cleanupForeachMaps=function(e){const t=[],n=[];this.interpolationMap.forEach((n,r)=>{e.contains(r)&&r!==e&&t.push(r)}),this.textInterpolationMap.forEach((t,r)=>{e.contains(r)&&n.push(r)}),t.forEach(e=>{this.interpolationMap.delete(e)}),n.forEach(e=>{this.textInterpolationMap.delete(e)})},d.prototype.establishHierarchy=function(){const{parent:e,children:t}=window.PACRegistry.getHierarchy(this.container);this.updateParentRelationship(e),this.updateChildrenRelationships(t),this.abstraction.childrenCount=this.children.size,this.abstraction.hasParent=!!this.parent,this.scanAndRegisterNewElements(this.container)},d.prototype.updateParentRelationship=function(e){this.parent!==e&&(this.parent&&this.parent.children.delete(this),this.parent=e,e&&e.children.add(this))},d.prototype.updateChildrenRelationships=function(e){this.children.clear(),e.forEach(e=>{e.parent&&e.parent!==this&&e.parent.children.delete(e),e.parent=this,this.children.add(e)})},d.prototype.notifyParent=function(e,t){this.parent&&"function"==typeof this.parent.receiveUpdate&&this.parent.receiveUpdate(e,t,this)},d.prototype.receiveUpdate=function(e,t,n){this.abstraction.receiveFromChild&&"function"==typeof this.abstraction.receiveFromChild&&this.abstraction.receiveFromChild(e,t,n)},d.prototype.receiveFromParent=function(e,t){this.abstraction.receiveFromParent&&"function"==typeof this.abstraction.receiveFromParent&&this.abstraction.receiveFromParent(e,t)},d.prototype.notifyChildren=function(e,t){this.children.forEach(n=>{n&&"function"==typeof n.receiveFromParent&&n.receiveFromParent(e,t)})},d.prototype.notifyChild=function(e,t,n){const r=Array.from(this.children).find(t=>t.container.matches(e));r&&"function"==typeof r.receiveFromParent&&r.receiveFromParent(t,n)},d.prototype.createContentHash=function(e){const t=this;return null==e||"object"!=typeof e?String(e):Array.isArray(e)?"["+e.map(this.createContentHash).join(",")+"]":"{"+Object.keys(e).sort().map(n=>`${n}:${t.createContentHash(e[n])}`).join(",")+"}"},d.prototype.createForeachEntryHash=function(e,t){if("number"!=typeof t||t<0||!Number.isInteger(t))throw new Error("index must be a non-negative integer");const n=`${t}|${this.createContentHash(e)}`;return o.djb2Hash(n)},d.prototype.classifyArrayChanges=function(e,t){const n=this,r=new Map;t.forEach((e,t)=>{const i=n.createForeachEntryHash(e,t);r.set(i,t)});const i={removed:[],moved:[],added:[],unchanged:[]};return e.forEach((e,t)=>{r.has(t)||i.removed.push(e)}),r.forEach((t,n)=>{if(e.has(n)){const r=e.get(n);r===t?i.unchanged.push(t):i.moved.push({from:r,to:t,hash:n})}else i.added.push(t)}),i.removed.sort((e,t)=>t-e),i.moved.sort((e,t)=>e.to-t.to),i.added.sort((e,t)=>e-t),i},d.prototype.canHandleSimply=function(e){const t=e.added.length+e.removed.length+e.moved.length;return!(t>10)&&(e.added.length>0&&0===e.removed.length&&0===e.moved.length||e.removed.length>0&&0===e.added.length&&0===e.moved.length||e.moved.length>0&&0===e.added.length&&0===e.removed.length||e.added.length===e.removed.length&&0===e.moved.length||t<=3)},d.prototype.handleSimpleArrayChange=function(e,t,n,r){const i=this.interpolationMap.get(e);t.removed.length>0&&this.removeItems(e,t.removed),t.moved.length>0&&this.moveItems(e,t.moved),t.added.length>0&&this.addItems(e,t.added,n,i,r),e._pacPreviousArray=n},d.prototype.removeItems=function(e,t){if(!(e instanceof Element))throw new TypeError("element must be a DOM Element");if(!Array.isArray(t))throw new TypeError("removedIndices must be an array");t.forEach(t=>{this.findItemNodes(e,t).forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&this.interpolationMap.has(e)&&this.interpolationMap.delete(e),e.nodeType===Node.TEXT_NODE&&this.textInterpolationMap.has(e)&&this.textInterpolationMap.delete(e),e.remove()})})},d.prototype.moveItems=function(e,t){if(!(e instanceof Element))throw new TypeError("element must be a DOM Element");if(!Array.isArray(t))throw new TypeError("moves must be an array");t.forEach(t=>{if("object"!=typeof t||null===t)throw new TypeError("each move must be an object");if("number"!=typeof t.from||"number"!=typeof t.to)throw new TypeError('move objects must have numeric "from" and "to" properties');if(t.from<0||t.to<0)throw new RangeError("move indices cannot be negative");const n=this.findItemNodes(e,t.from),r=this.findInsertionPoint(e,t.to);n.forEach(t=>{r?e.insertBefore(t,r):e.appendChild(t)})})},d.prototype.addItems=function(e,t,n,r,i){const a=this.arrayHashMaps.get(i)||new Map,o=this.getSourceArrayForFiltered(r.foreachExpr,n);t.forEach(t=>{const i=n[t],s=this.findOriginalIndex(i,o,t),c=this.createForeachEntryHash(i,s);a.set(c,s);const h=`\x3c!-- pac-foreach-item: ${r.foreachId}, index=${s}, renderIndex=${t} --\x3e`+r.template+"\x3c!-- /pac-foreach-item --\x3e",l=document.createElement("div");l.innerHTML=h;const d=this.findInsertionPoint(e,t);for(;l.firstChild;)d?e.insertBefore(l.firstChild,d):e.appendChild(l.firstChild)}),this.arrayHashMaps.set(i,a),this.scanAndRegisterNewElements(e)},d.prototype.findItemNodes=function(e,t){const r=[],i=document.createTreeWalker(e,NodeFilter.SHOW_ALL);let a,o=!1,s=0;for(;a=i.nextNode();)if(a.nodeType===Node.COMMENT_NODE){const e=a.textContent.trim(),i=e.match(n);if(i&&parseInt(i[2],10)===t&&!o)o=!0,s=0,r.push(a);else if(o)if(r.push(a),i)s++;else if("/pac-foreach-item"===e){if(0===s)break;s--}}else o&&r.push(a);return r},d.prototype.findInsertionPoint=function(e,t){const r=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT);let i;for(;i=r.nextNode();){const e=i.textContent.match(n);if(e&&parseInt(e[3],10)>=t)return i}return null},p.prototype={register(e,t){this.components.set(e,t),this.hierarchyCache=new WeakMap},unregister(e){const t=this.components.get(e);return t&&(t.destroy(),this.components.delete(e)),t},getHierarchy(e){if(this.hierarchyCache.has(e))return this.hierarchyCache.get(e);let t=null,n=e.parentElement;for(;n&&!t;)this.components.forEach(e=>{e.container===n&&(t=e)}),n=n.parentElement;const r=[];this.components.forEach(t=>{e.contains(t.container)&&t.container!==e&&r.push(t)});const i={parent:t,children:r};return this.hierarchyCache.set(e,i),i}},window.PACRegistry=window.PACRegistry||new p,window._wakaPACHierarchyListener||(window._wakaPACHierarchyListener=!0,document.addEventListener("pac:component-ready",()=>{clearTimeout(window._wakaPACHierarchyTimeout),window._wakaPACHierarchyTimeout=setTimeout(()=>{window.PACRegistry.hierarchyCache=new WeakMap,window.PACRegistry.components.forEach(e=>{e.establishHierarchy()})},10)})),window.wakaPAC=function(e,t,n){s.initialize();const r=document.querySelector(e);if(!r)throw new Error(`Container not found: ${e}`);r.hasAttribute("data-pac-container")||r.setAttribute("data-pac-container",o.uniqid());const i=new d(r,t,Object.assign({updateMode:"immediate",delay:300},n));return window.PACRegistry.register(e,i),document.dispatchEvent(new CustomEvent("pac:component-ready",{detail:{component:i,selector:e}})),i.abstraction},window.MSG_TYPES=a}();
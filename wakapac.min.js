!function(){"use strict";const e=/\{\{\s*([^}]+)\s*}}/g,t=/\{\{.*}}/,n=["value","checked","visible","if","foreach","class","style","click","change","input","submit","focus","blur","keyup","keydown"],r={belongsToThisContainer(e,t){this._cache||(this._cache=new WeakMap);const n=this._cache.get(t);if(n===e)return!0;if(!1===n)return!1;let r;if(t.nodeType===Node.TEXT_NODE){const n=t.parentElement;r=n&&e.contains(n)&&n.closest("[data-pac-container]")===e}else r=e.contains(t)&&t.closest("[data-pac-container]")===e;return this._cache.set(t,!!r&&e),r},readDOMValue:e=>{let t;if(t="string"!=typeof e?e&&e.nodeType?e:null:e.startsWith("#")?document.getElementById(e.slice(1)):document.querySelector(e),!t)return!1;switch(!0){case"SELECT"===t.tagName:return t.value;case"checkbox"===t.type:return t.checked;case"radio"===t.type:{const e=document.querySelector('input[name="'+t.name+'"]:checked');return e?e.value:""}case"INPUT"===t.tagName||"TEXTAREA"===t.tagName:return t.value;default:return t.textContent||t.innerText}},writeDOMValue:(e,t)=>{let n;if(n="string"!=typeof e?e&&e.nodeType?e:null:e.startsWith("#")?document.getElementById(e.slice(1)):document.querySelector(e),!n)return!1;switch(!0){case"SELECT"===n.tagName:return n.value=t,n.dispatchEvent(new Event("change",{bubbles:!0})),!0;case"checkbox"===n.type:return n.checked=Boolean(t),n.dispatchEvent(new Event("change",{bubbles:!0})),!0;case"radio"===n.type:{const e=document.querySelector('input[name="'+n.name+'"][value="'+t+'"]');return!!e&&(e.checked=!0,e.dispatchEvent(new Event("change",{bubbles:!0})),!0)}case"INPUT"===n.tagName||"TEXTAREA"===n.tagName:return n.value=t,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0})),!0;default:return n.textContent=t,!0}}};function i(e,t,n,r){if(e._context||n&&n._analyzingDependencies)return e;const i={};["filter","map","reduce","forEach","find","some","every","includes","indexOf","slice","push","pop","shift","unshift","splice","sort","reverse"].forEach(t=>{"function"==typeof e[t]&&(i[t]=e[t].bind(e))});const c=new l(t,{items:e,parent:n,originalMethods:i},n);Object.defineProperty(e,"_context",{value:c,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"parent",{value:n,writable:!1,enumerable:!1,configurable:!0}),["filter","map","reduce","forEach","find","some","every","includes","indexOf","slice"].forEach(t=>{e[t]=function(...e){return this._context.abstraction.originalMethods[t](...e)}});const o=Object.getOwnPropertyDescriptor(e,"length");return o&&!o.configurable||Object.defineProperty(e,"length",{get(){return this._context?this._context.abstraction.items.length:0},configurable:!0}),["push","pop","shift","unshift","splice","sort","reverse"].forEach(i=>{e[i]=function(...e){const c=this._context.abstraction.originalMethods[i](...e);return a(this),s(this,t,n),t.dispatchEvent(new CustomEvent("pac:array-change",{detail:{path:r,method:i,array:this,context:this._context}})),c}}),e}function a(e){Array.isArray(e)&&e.forEach((e,t)=>{var n;Array.isArray(e)&&e._context&&(a(e),e._context.destroy(),delete e._context,delete e._hasContext,e.parent&&delete e.parent,n=e,["push","pop","shift","unshift","splice","sort","reverse"].forEach(e=>{Object.prototype.hasOwnProperty.call(n,e)&&delete n[e]}))})}function s(e,t,n){Array.isArray(e)&&e.forEach((e,r)=>{Array.isArray(e)&&!e._context&&i(e,t,n,[r])})}const c={_initialized:!1,initialize(){const e=this;this._initialized||(this._initialized=!0,document.addEventListener("click",function(t){e.dispatchTrackedEvent("pac:dom:click",t,{clientX:t.clientX??null,clientY:t.clientY??null,pageX:t.pageX??null,pageY:t.pageY??null,screenX:t.screenX??null,screenY:t.screenY??null,button:t.button??null,buttons:t.buttons??null})}),document.addEventListener("change",function(t){e.dispatchTrackedEvent("pac:dom:change",t)}),document.addEventListener("input",function(t){e.dispatchTrackedEvent("pac:dom:change",t)}),document.addEventListener("submit",function(t){const n=new FormData(t.target),r=Object.fromEntries(n.entries());e.dispatchTrackedEvent("pac:dom:submit",t,{formId:t.target.id||null,formData:r,elementCount:t.target.elements.length})}))},dispatchTrackedEvent(e,t,n={}){const i=t.target.closest("[data-pac-container]");i&&i.dispatchEvent(new CustomEvent(e,{detail:{timestamp:Date.now(),id:t.target.id||null,elementType:t.target.type||t.target.tagName.toLowerCase(),elementName:t.target.name||null,target:t.target,value:r.readDOMValue(t.target),originalEvent:t,bindString:t.target.getAttribute("data-pac-bind")??"",extra:n}}))}},o={tokens:[],currentToken:0,OPERATOR_PRECEDENCE:{"||":1,"&&":2,"===":6,"!==":6,"==":6,"!=":6,"<":7,">":7,"<=":7,">=":7,"+":8,"-":8,"*":9,"/":9,"%":9,"!":10,"unary-":10,"unary+":10},OPERATOR_TYPES:{"||":"logical","&&":"logical","===":"comparison","!==":"comparison","==":"comparison","!=":"comparison",">=":"comparison","<=":"comparison",">":"comparison","<":"comparison","+":"arithmetic","-":"arithmetic","*":"arithmetic","/":"arithmetic","%":"arithmetic"},parseExpression(e){if("object"==typeof e&&null!==e){if(e.dependencies)return e;const t=this.extractDependencies(e);return Object.assign({},e,{dependencies:t})}if(e=String(e).trim(),this.tokens=this.tokenize(e),this.currentToken=0,0===this.tokens.length)return null;const t=this.parseTernary();return t&&(t.dependencies=this.extractDependencies(t)),t},tokenize(e){const t=[];let n=0;for(;n<e.length;){const r=e[n];if(/\s/.test(r)){n++;continue}if('"'===r||"'"===r){const r=this.tokenizeString(e,n);t.push(r.token),n=r.nextIndex;continue}if(/\d/.test(r)||"."===r&&/\d/.test(e[n+1])){const r=this.tokenizeNumber(e,n);t.push(r.token),n=r.nextIndex;continue}const i=/^(===|!==|==|!=|>=|<=|&&|\|\|)/.exec(e.slice(n));if(i){const e=i[1];t.push({type:"OPERATOR",value:e,precedence:this.getOperatorPrecedence(e)}),n+=e.length;continue}const a={"(":"LPAREN",")":"RPAREN","{":"LBRACE","}":"RBRACE","[":"LBRACKET","]":"RBRACKET",",":"COMMA",".":"DOT"};if(a[r])t.push({type:a[r],value:r}),n++;else{if("+-*/<>!?:%".includes(r)){const e=this.getOperatorPrecedence(r);let i;switch(r){case"?":i="QUESTION";break;case":":i="COLON";break;default:i="OPERATOR"}t.push({type:i,value:r,precedence:e}),n++;continue}if(/[a-zA-Z_$]/.test(r)){const r=this.tokenizeIdentifier(e,n);t.push(r.token),n=r.nextIndex;continue}n++}}return t},tokenizeString(e,t){const n=e[t];let r=t+1,i="";for(;r<e.length;){const t=e[r];if("\\"===t&&r+1<e.length){const a=e[r+1];a===n||"\\"===a?(i+=a,r+=2):(i+=t,r++)}else{if(t===n)return{token:{type:"STRING",value:i},nextIndex:r+1};i+=t,r++}}throw new Error(`Unterminated string literal starting at position ${t}: expected closing ${n}`)},tokenizeNumber(e,t){const n=/^(\d*\.?\d+(?:[eE][+-]?\d+)?)/.exec(e.slice(t));if(n)return{token:{type:"NUMBER",value:parseFloat(n[1])},nextIndex:t+n[1].length}},tokenizeIdentifier(e,t){const n=/^([a-zA-Z_$][a-zA-Z0-9_$]*)/.exec(e.slice(t));if(n){const e=n[1];return{token:{type:["true","false","null","undefined"].includes(e)?"KEYWORD":"IDENTIFIER",value:e},nextIndex:t+e.length}}},getOperatorPrecedence(e){return this.OPERATOR_PRECEDENCE[e]||0},parseTernary(){let e=this.parseBinaryWithPrecedence(1);if(this.match("QUESTION")){const t=this.parseTernary();return this.consume("COLON",'Expected ":" in ternary expression'),{type:"ternary",condition:e,trueValue:t,falseValue:this.parseTernary()}}return e},parseBinaryWithPrecedence(e){let t=this.parseUnary();for(;"OPERATOR"===this.peek().type;){const n=this.getOperatorPrecedence(this.peek().value);if(n<e)break;const r=this.advance().value,i=this.parseBinaryWithPrecedence(n+1);t={type:this.OPERATOR_TYPES[r]||"arithmetic",left:t,operator:r,right:i}}return t},parseUnary(){return this.matchOperator("!","-","+")?{type:"unary",operator:this.previous().value,operand:this.parseUnary()}:this.parsePrimary()},parsePrimary(){if(this.match("LPAREN")){const e=this.parseTernary();return this.consume("RPAREN","Expected closing parenthesis"),{type:"parentheses",inner:e}}if(this.match("LBRACE"))return this.parseObjectLiteral();if(this.check("STRING"))return{type:"literal",value:this.advance().value};if(this.check("NUMBER"))return{type:"literal",value:this.advance().value};if(this.check("KEYWORD")){let e;switch(this.advance().value){case"true":e=!0;break;case"false":e=!1;break;case"null":e=null;break;case"undefined":e=void 0}return{type:"literal",value:e}}return this.check("IDENTIFIER")?this.parsePropertyAccess():null},parseObjectLiteral(){const e=[];if(!this.check("RBRACE"))do{let t;if(this.check("STRING"))t=this.advance().value;else{if(!this.check("IDENTIFIER"))throw new Error("Expected property name");t=this.advance().value}this.consume("COLON",'Expected ":" after object key');const n=this.parseTernary();e.push({key:t,value:n})}while(this.match("COMMA")&&!this.check("RBRACE"));return this.consume("RBRACE","Expected closing brace"),{type:"object",pairs:e}},parsePropertyAccess(){let e=this.advance().value;for(;;)if(this.match("DOT")){if(!this.check("IDENTIFIER"))throw new Error('Expected property name after "."');e+="."+this.advance().value}else{if(!this.match("LBRACKET"))break;{const t=this.parseTernary();this.consume("RBRACKET","Expected closing bracket"),"literal"===t.type?e+="["+JSON.stringify(t.value)+"]":e+="["+this.reconstructExpression(t)+"]"}}return{type:"property",path:e}},reconstructExpression(e){if(!e)return"";switch(e.type){case"literal":return"string"==typeof e.value?'"'+e.value+'"':String(e.value);case"property":return e.path;case"arithmetic":return`${this.reconstructExpression(e.left)} ${e.operator} ${this.reconstructExpression(e.right)}`;default:return"unknown"}},match(...e){for(const t of e)if(this.check(t))return this.advance(),!0;return!1},matchOperator(...e){if(this.check("OPERATOR")){const t=this.peek();if(e.includes(t.value))return this.advance(),!0}return!1},check(e){return!this.isAtEnd()&&this.peek().type===e},advance(){return this.isAtEnd()||this.currentToken++,this.previous()},isAtEnd(){return this.currentToken>=this.tokens.length},peek(){return this.tokens[this.currentToken]||{type:"EOF",value:null}},previous(){return this.tokens[this.currentToken-1]},consume(e,t){if(this.check(e))return this.advance();throw new Error(t+` at token: ${JSON.stringify(this.peek())}`)},lookupInScopeChain(e,t){let n=e;for(;n&&n!==Object.prototype;){if(Object.prototype.hasOwnProperty.call(n,t))return n[t];n=Object.getPrototypeOf(n)}},evaluate(e,t){if(e)switch(e.type){case"literal":return e.value;case"property":return this.getProperty(e.path,t);case"parentheses":return this.evaluate(e.inner,t);case"object":return this.evaluateObjectLiteral(e,t);case"ternary":return this.evaluate(e.condition,t)?this.evaluate(e.trueValue,t):this.evaluate(e.falseValue,t);case"logical":{const n=this.evaluate(e.left,t);return"&&"===e.operator?!!n&&this.evaluate(e.right,t):"||"===e.operator&&(!!n||this.evaluate(e.right,t))}case"comparison":case"arithmetic":{const n=this.evaluate(e.left,t),r=this.evaluate(e.right,t);return this.performOperation(n,e.operator,r)}case"unary":{const n=this.evaluate(e.operand,t);switch(e.operator){case"!":return!n;case"-":return-n;case"+":return+n;default:return n}}default:return}},getProperty(e,t){if(!t||!e)return;if(-1===e.indexOf("."))return e in t?t[e]:void 0;const n=e.split(".");let r=t;for(let e=0;e<n.length;e++){if(null==r)return;r=r[n[e]]}return r},evaluateObjectLiteral(e,t){const n={};return e.pairs&&e.pairs.forEach(({key:e,value:r})=>{n[e]=this.evaluate(r,t)}),n},performOperation(e,t,n){switch(t){case"+":return e+n;case"-":return Number(e)-Number(n);case"*":return Number(e)*Number(n);case"/":return Number(e)/Number(n);case"%":return Number(e)%Number(n);case"===":return e===n;case"!==":return e!==n;case"==":return e==n;case"!=":return e!=n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n;default:return!1}},extractDependencies(e){if(!e)return[];const t=new Set,n=e=>{if(e)switch(e.type){case"property":{const n=e.path.split(/[.[]/,1)[0];n&&!["true","false","null","undefined"].includes(n)&&t.add(n);break}case"ternary":n(e.condition),n(e.trueValue),n(e.falseValue);break;case"logical":case"comparison":case"arithmetic":n(e.left),n(e.right);break;case"unary":n(e.operand);break;case"parentheses":n(e.inner);break;case"object":e.pairs&&e.pairs.forEach(e=>n(e.value))}};return n(e),Array.from(t)},parseBindingString(e){const t=[];let n="",r=!1,i="",a=0,s=0;for(let c=0;c<e.length;c++){const o=e[c],u=c>0&&"\\"===e[c-1];'"'!==o&&"'"!==o||u||(r?o===i&&(r=!1,i=""):(r=!0,i=o)),r||("("===o?a++:")"===o?a--:"{"===o?s++:"}"===o&&s--),","!==o||r||0!==a||0!==s?n+=o:(this.addBindingPairIfValid(n,t),n="")}return this.addBindingPairIfValid(n,t),t},addBindingPairIfValid(e,t){const n=e.trim();if(!n)return;const r=this.findBindingColon(n);-1===r?t.push({type:n,target:""}):t.push({type:n.substring(0,r).trim(),target:n.substring(r+1).trim()})},findBindingColon(e){for(const t of n)if(e.startsWith(t+":"))return t.length;let t=!1,r="",i=0;for(let n=0;n<e.length;n++){const a=e[n],s=n>0&&"\\"===e[n-1];if('"'!==a&&"'"!==a||s||(t?a===r&&(t=!1,r=""):(t=!0,r=a)),!t)if("("===a)i++;else if(")"===a)i--;else if(":"===a&&0===i)return n}return-1}};function u(e){this.container=e}function l(e,t,n=null){const r=this;e.hasAttribute("data-pac-container")||e.setAttribute("data-pac-container",this.uniqid()),this.originalAbstraction=t,this.parent=n,this.container=e,this.abstraction=this.createReactiveAbstraction(),this.domUpdater=new u(this.container),this.dependencies=this.getDependencies(),this.clickInterpolationMap=this.scanClickBindings(),this.textInterpolationMap=this.scanTextBindings(),this.attributeInterpolationMap=this.scanAttributeBindings(),this.processForeachBindings(),this.boundHandleDomClicks=function(e){r.handleDomClicks(e)},this.boundHandleDomChange=function(e){r.handleDomChange(e)},this.boundHandleReactiveChange=function(e){r.handleReactiveChange(e)},this.boundHandleArrayChange=function(e){r.handleArrayChange(e)},this.container.addEventListener("pac:dom:click",this.boundHandleDomClicks),this.container.addEventListener("pac:dom:change",this.boundHandleDomChange),this.container.addEventListener("pac:change",this.boundHandleReactiveChange),this.container.addEventListener("pac:array-change",this.boundHandleArrayChange),this.textInterpolationMap.forEach((e,t)=>{r.domUpdater.updateTextNode(t,e.template,r.abstraction)}),this.attributeInterpolationMap.forEach(e=>{const{element:t,bindings:n}=e;n.forEach(e=>{r.domUpdater.updateAttributeBinding(t,e,r.abstraction)})})}new Map,u.prototype.updateTextNode=function(t,n,r){const i=n.replace(e,(e,t)=>{try{const e=o.parseExpression(t.trim()),n=o.evaluate(e,r);return null!=n?String(n):""}catch(t){return e}});t.textContent!==i&&(t.textContent=i)},u.prototype.updateAttributeBinding=function(e,t,n){try{const r=o.parseExpression(t.target),i=o.evaluate(r,n);switch(t.type){case"value":this.applyValueBinding(e,i);break;case"checked":this.applyCheckedBinding(e,i);break;case"visible":this.applyVisibleBinding(e,i);break;case"class":this.applyClassBinding(e,i);break;case"style":this.applyStyleBinding(e,i);break;default:this.applyAttributeBinding(e,t.type,i)}}catch(e){}},u.prototype.applyValueBinding=function(e,t){if("radio"!==e.type){if("value"in e){const n=String(t||"");e.value!==n&&(e.value=n)}}else e.checked=e.value===String(t)},u.prototype.applyCheckedBinding=function(e,t){"checkbox"!==e.type&&"radio"!==e.type||(e.checked=Boolean(t))},u.prototype.applyVisibleBinding=function(e,t){if(t)e.hasAttribute("data-pac-hidden")&&(e.style.display=e.getAttribute("data-pac-orig-display")||"",e.removeAttribute("data-pac-hidden"),e.removeAttribute("data-pac-orig-display"));else if(!e.hasAttribute("data-pac-hidden")){const t=getComputedStyle(e).display;"none"!==t&&e.setAttribute("data-pac-orig-display",t),e.style.display="none",e.setAttribute("data-pac-hidden","true")}},u.prototype.applyClassBinding=function(e,t){"string"==typeof t?e.className=t:"object"==typeof t&&null!==t&&Object.keys(t).forEach(n=>{t[n]?e.classList.add(n):e.classList.remove(n)})},u.prototype.applyStyleBinding=function(e,t){"object"!=typeof t||null===t||Array.isArray(t)?"string"==typeof t&&(e.style.cssText=t):Object.keys(t).forEach(n=>{null!=t[n]&&(n.startsWith("--")?e.style.setProperty(n,t[n]):e.style[n]=t[n])})},u.prototype.applyAttributeBinding=function(e,t,n){"enable"===t?e.toggleAttribute("disabled",!n):["readonly","required","selected","checked","hidden","multiple","autofocus"].includes(t)?e.toggleAttribute(t,!!n):null!=n?e.setAttribute(t,n):e.removeAttribute(t)},l.prototype.destroy=function(){this.container.removeEventListener("pac:dom:click",this.boundHandleDomClicks),this.container.removeEventListener("pac:dom:change",this.boundHandleDomChange),this.container.removeEventListener("pac:change",this.boundHandleReactiveChange),this.container.removeEventListener("pac:array-change",this.boundHandleArrayChange),this.boundHandleDomClicks=null,this.boundHandleDomChange=null,this.boundHandleReactiveChange=null},l.prototype.uniqid=function(e="",t=!1){return`${e}${(1e3*Date.now()+1e3*Math.random()).toString(16).replace(/\./g,"").padEnd(14,"0")}${t?`.${Math.trunc(1e8*Math.random())}`:""}`},l.prototype.getDependencies=function(){const e=new Map,t=this.originalAbstraction.computed||{},n=new Set;this._analyzingDependencies=!0;const r=new Proxy(this.originalAbstraction,{get:(e,t)=>("string"==typeof t&&n.add(t),e[t])});return Object.keys(t).forEach(i=>{n.clear(),t[i].call(r),n.forEach(t=>{e.has(t)||e.set(t,[]),e.get(t).push(i)})}),this._analyzingDependencies=!1,e},l.prototype.handleAttributeChanges=function(e,t){const n=this;this.attributeInterpolationMap.forEach(e=>{const{element:r,bindings:i}=e;i.forEach(e=>{e.dependencies.some(e=>t.includes(e))&&n.domUpdater.updateAttributeBinding(r,e,n.abstraction)})})},l.prototype.handleTextInterpolation=function(e,t){const n=this;n.textInterpolationMap.forEach((e,r)=>{e.dependencies.some(e=>t.includes(e))&&n.domUpdater.updateTextNode(r,e.template,n.abstraction)})},l.prototype.handleDomClicks=function(e){const t=this,n=this.clickInterpolationMap.find(t=>t.element===e.detail.target);n&&0!==n.bindings.length&&n.bindings.forEach(function(n){const r=t.abstraction[n.target];if("function"==typeof r)try{r.call(t.abstraction,e)}catch(e){}})},l.prototype.handleDomChange=function(e){const t=this;o.parseBindingString(e.detail.bindString).forEach(function(n){"value"!==n.type&&"checked"!==n.type||!n.target||(t.setNestedProperty(n.target,e.detail.value),t.parent&&t.notifyParentOfChange(n.target,e.detail.value))})},l.prototype.notifyParentOfChange=function(e,t){if(!this.parent)return;const n=this.parentArrayPath;n&&this.parent.container.dispatchEvent(new CustomEvent("pac:change",{detail:{childChange:!0,path:[n],oldValue:null,newValue:null,childPath:e,childValue:t}}))},l.prototype.setNestedProperty=function(e,t){if(!e)return;const n=e.split(".");let r=this.abstraction;for(let e=0;e<n.length-1;e++){const t=n[e];if(void 0===r[t])return;r=r[t]}const i=n[n.length-1];r&&"object"==typeof r&&(r[i]=t)},l.prototype.handleReactiveChange=function(e){const t=e.detail.path.join("."),n=[t];this.dependencies.has(t)&&n.push(...this.dependencies.get(t)),this.handleTextInterpolation(e,n),this.handleAttributeChanges(e,n)},l.prototype.handleArrayChange=function(e){const t=e&&e.detail;if(!t||!Array.isArray(t.path))return;const n=t.path.join(".");this.container.querySelectorAll('[data-pac-bind*="foreach:"]').forEach(e=>{if(!r.belongsToThisContainer(this.container,e))return;const t=this.extractForeachBinding(e.getAttribute("data-pac-bind"));t&&t.target&&(n===t.target||n.endsWith("."+t.target))&&this.renderForeachItems(e)})},l.prototype.scanTextBindings=function(){const e=new Map,n=document.createTreeWalker(this.container,NodeFilter.SHOW_TEXT,{acceptNode:e=>t.test(e.textContent)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});let i;for(;i=n.nextNode();)if(r.belongsToThisContainer(this.container,i)){const t=i.textContent,n=this.extractInterpolationDependencies(t);e.set(i,{template:t,dependencies:n})}return e},l.prototype.scanAttributeBindings=function(){const e=this,t=this.container.querySelectorAll("[data-pac-bind]"),n=[];return t.forEach(t=>{if(!r.belongsToThisContainer(e.container,t))return;const i=t.getAttribute("data-pac-bind"),a=o.parseBindingString(i).filter(e=>"click"!==e.type&&"foreach"!==e.type&&e.target);if(0===a.length)return;const s=a.map(e=>({...e,dependencies:this.extractDependencies(e.target)}));n.push({element:t,bindingString:i,bindings:s})}),n},l.prototype.scanClickBindings=function(){const e=this,t=this.container.querySelectorAll("[data-pac-bind]"),n=[];return t.forEach(t=>{if(!r.belongsToThisContainer(e.container,t))return;const i=t.getAttribute("data-pac-bind"),a=o.parseBindingString(i).filter(e=>"click"===e.type);if(0===a.length)return;const s=a.map(e=>({...e,dependencies:this.extractDependencies(e.target)}));n.push({element:t,bindingString:i,bindings:s})}),n},l.prototype.extractInterpolationDependencies=function(t){const n=new Set;return t.replace(e,(e,t)=>(this.extractDependencies(t.trim()).forEach(e=>n.add(e)),e)),Array.from(n)},l.prototype.extractDependencies=function(e){try{const t=o.parseExpression(e);return t?.dependencies||[]}catch(e){return[]}},l.prototype.createReactiveAbstraction=function(){const e=this,t=function(e,t,n=null){const r=["push","pop","shift","unshift","splice","sort","reverse"];return e&&"object"==typeof e?(c=e,o=(o=[])||[],Array.isArray(c)?i(c,t,n,o):function(e,c){return new Proxy(e,{get:function(e,o){const u=e[o];if(Array.isArray(e)&&"function"==typeof u&&r.includes(o))return function(){const r=Array.prototype[o].apply(e,arguments);return a(e),s(e,t,n),t.dispatchEvent(new CustomEvent("pac:array-change",{detail:{path:c,method:o,target:e}})),r};if(Array.isArray(u)&&!u._hasContext)return i(u,t,n,c.concat([o]));const l=Object.getOwnPropertyDescriptor(e,o);return l&&l.get&&l.set,u},set:function(e,r,a){const s=e[r];return Array.isArray(a)?e[r]=i(a,t,n,c.concat([r])):e[r]=a,t.dispatchEvent(new CustomEvent("pac:change",{detail:{path:c.concat([r]),oldValue:s,newValue:e[r]}})),!0}})}(c,o)):e;var c,o}(this.originalAbstraction,this.container);Object.keys(this.originalAbstraction).forEach(function(n){"function"==typeof e.originalAbstraction[n]&&"computed"!==n&&(t[n]=e.originalAbstraction[n].bind(t))});const n=this.originalAbstraction.computed||{};return Object.keys(n).forEach(function(e){Object.defineProperty(t,e,{get:function(){return n[e].call(t)},enumerable:!0,configurable:!0})}),t},l.prototype.processForeachBindings=function(){this.container.querySelectorAll('[data-pac-bind*="foreach:"]').forEach(e=>{if(!r.belongsToThisContainer(this.container,e))return;const t=e.getAttribute("data-pac-bind"),n=this.extractForeachBinding(t);n&&this.setupForeachBinding(e,n)})},l.prototype.extractForeachBinding=function(e){return o.parseBindingString(e).find(e=>"foreach"===e.type)||null},l.prototype.setupForeachBinding=function(e,t){const n=t.target,r=e.getAttribute("data-pac-item")||"item",i=e.getAttribute("data-pac-index")||"index",a=e.children[0];if(!a)return;const s=a.cloneNode(!0);e.innerHTML="",e._foreachData={arrayPath:n,itemName:r,indexName:i,template:s,renderedItems:[]},this.renderForeachItems(e)},l.prototype.renderForeachItems=function(e){const t=e._foreachData;if(!t)return;const n=o.getProperty(t.arrayPath,this.abstraction);Array.isArray(n)&&(this.clearForeachItems(e),n.forEach((t,n)=>{this.renderForeachItem(e,t,n)}))},l.prototype.renderForeachItem=function(e,t,n){const r=e._foreachData,i=r.template.cloneNode(!0),a=new l(i,this.createItemAbstraction(t,n,r),this);a.parentArrayPath=r.arrayPath,r.renderedItems.push({element:i,context:a,item:t,index:n}),e.appendChild(i)},l.prototype.createItemAbstraction=function(e,t,n){const r={[n.itemName]:e,[n.indexName]:t,parent:this};return new Proxy(r,{get(e,t){if(t in e)return e[t];const r=e.parent.abstraction[t];return"function"==typeof r?function(...t){return r.call(e.parent.abstraction,e[n.itemName],e[n.indexName],...t)}:r},set:(e,t,n)=>(e[t]=n,!0)})},l.prototype.clearForeachItems=function(e){const t=e._foreachData;t&&(t.renderedItems.forEach(e=>{e.context.destroy(),e.element.remove()}),t.renderedItems=[])},window.PACRegistry=window.PACRegistry||new function(){this.components=new Map,this.register=function(e,t){this.components.set(e,t)},this.unregister=function(e){this.components.delete(e)}},window.wakaPAC=function(e,t,n){c.initialize();const r=document.querySelector(e);if(!r)throw new Error(`Container not found: ${e}`);const i={selector:e,container:r,config:Object.assign({updateMode:"immediate",delay:300},n),context:new l(r,t),initialize:function(){return this}},a=i.initialize();return window.PACRegistry.register(e,i),a.abstraction}}();